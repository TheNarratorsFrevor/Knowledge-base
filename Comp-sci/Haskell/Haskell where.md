<h2>Where!?</h2>
<p>In the previous section, we defined a BMI calculator function and berator like this:</p>
<div class="dp-highlighter nogutter"><div class="bar"></div><ol class="dp-hs" start="1"><li class="alt"><span><span>bmiTell</span><span class="syntax_operators">&nbsp;::&nbsp;</span><span>(</span><span class="type_constructors">RealFloat</span><span>&nbsp;a)</span><span class="syntax_operators">&nbsp;=&gt;&nbsp;</span><span>a</span><span class="syntax_operators">&nbsp;-&gt;&nbsp;</span><span>a</span><span class="syntax_operators">&nbsp;-&gt;&nbsp;</span><span class="type_constructors">String</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>bmiTell&nbsp;weight&nbsp;height&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;<span class="common_operators">&nbsp;|&nbsp;</span><span>weight</span><span class="common_operators">&nbsp;/&nbsp;</span><span>height</span><span class="common_operators">&nbsp;^&nbsp;</span><span class="numbers">2</span><span class="common_operators">&nbsp;&lt;=&nbsp;</span><span class="numbers">18.5</span><span class="common_operators">&nbsp;=&nbsp;</span><span class="string">"You're&nbsp;underweight,&nbsp;you&nbsp;emo,&nbsp;you!"</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;<span class="common_operators">&nbsp;|&nbsp;</span><span>weight</span><span class="common_operators">&nbsp;/&nbsp;</span><span>height</span><span class="common_operators">&nbsp;^&nbsp;</span><span class="numbers">2</span><span class="common_operators">&nbsp;&lt;=&nbsp;</span><span class="numbers">25.0</span><span class="common_operators">&nbsp;=&nbsp;</span><span class="string">"You're&nbsp;supposedly&nbsp;normal.&nbsp;Pffft,&nbsp;I&nbsp;bet&nbsp;you're&nbsp;ugly!"</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;<span class="common_operators">&nbsp;|&nbsp;</span><span>weight</span><span class="common_operators">&nbsp;/&nbsp;</span><span>height</span><span class="common_operators">&nbsp;^&nbsp;</span><span class="numbers">2</span><span class="common_operators">&nbsp;&lt;=&nbsp;</span><span class="numbers">30.0</span><span class="common_operators">&nbsp;=&nbsp;</span><span class="string">"You're&nbsp;fat!&nbsp;Lose&nbsp;some&nbsp;weight,&nbsp;fatty!"</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;<span class="common_operators">&nbsp;|&nbsp;</span><span>otherwise&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="common_operators">&nbsp;=&nbsp;</span><span class="string">"You're&nbsp;a&nbsp;whale,&nbsp;congratulations!"</span><span>&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="haskell:hs" style="display: none;">bmiTell :: (RealFloat a) =&gt; a -&gt; a -&gt; String
bmiTell weight height
    | weight / height ^ 2 &lt;= 18.5 = "You're underweight, you emo, you!"
    | weight / height ^ 2 &lt;= 25.0 = "You're supposedly normal. Pffft, I bet you're ugly!"
    | weight / height ^ 2 &lt;= 30.0 = "You're fat! Lose some weight, fatty!"
    | otherwise                   = "You're a whale, congratulations!"
</pre>
<p>Notice that we repeat ourselves here three times. We repeat ourselves three times. Repeating yourself (three times) while programming is about as desirable as getting kicked inna head. Since we repeat the same expression three times, it would be ideal if we could calculate it once, bind it to a name and then use that name instead of the expression. Well, we can modify our function like this:</p>
<div class="dp-highlighter nogutter"><div class="bar"></div><ol class="dp-hs" start="1"><li class="alt"><span><span>bmiTell</span><span class="syntax_operators">&nbsp;::&nbsp;</span><span>(</span><span class="type_constructors">RealFloat</span><span>&nbsp;a)</span><span class="syntax_operators">&nbsp;=&gt;&nbsp;</span><span>a</span><span class="syntax_operators">&nbsp;-&gt;&nbsp;</span><span>a</span><span class="syntax_operators">&nbsp;-&gt;&nbsp;</span><span class="type_constructors">String</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>bmiTell&nbsp;weight&nbsp;height&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;<span class="common_operators">&nbsp;|&nbsp;</span><span>bmi</span><span class="common_operators">&nbsp;&lt;=&nbsp;</span><span class="numbers">18.5</span><span class="common_operators">&nbsp;=&nbsp;</span><span class="string">"You're&nbsp;underweight,&nbsp;you&nbsp;emo,&nbsp;you!"</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;<span class="common_operators">&nbsp;|&nbsp;</span><span>bmi</span><span class="common_operators">&nbsp;&lt;=&nbsp;</span><span class="numbers">25.0</span><span class="common_operators">&nbsp;=&nbsp;</span><span class="string">"You're&nbsp;supposedly&nbsp;normal.&nbsp;Pffft,&nbsp;I&nbsp;bet&nbsp;you're&nbsp;ugly!"</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;<span class="common_operators">&nbsp;|&nbsp;</span><span>bmi</span><span class="common_operators">&nbsp;&lt;=&nbsp;</span><span class="numbers">30.0</span><span class="common_operators">&nbsp;=&nbsp;</span><span class="string">"You're&nbsp;fat!&nbsp;Lose&nbsp;some&nbsp;weight,&nbsp;fatty!"</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;<span class="common_operators">&nbsp;|&nbsp;</span><span>otherwise&nbsp;&nbsp;</span><span class="common_operators">&nbsp;=&nbsp;</span><span class="string">"You're&nbsp;a&nbsp;whale,&nbsp;congratulations!"</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword2">where</span><span>&nbsp;bmi</span><span class="common_operators">&nbsp;=&nbsp;</span><span>weight</span><span class="common_operators">&nbsp;/&nbsp;</span><span>height</span><span class="common_operators">&nbsp;^&nbsp;</span><span class="numbers">2</span><span>&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="haskell:hs" style="display: none;">bmiTell :: (RealFloat a) =&gt; a -&gt; a -&gt; String
bmiTell weight height
    | bmi &lt;= 18.5 = "You're underweight, you emo, you!"
    | bmi &lt;= 25.0 = "You're supposedly normal. Pffft, I bet you're ugly!"
    | bmi &lt;= 30.0 = "You're fat! Lose some weight, fatty!"
    | otherwise   = "You're a whale, congratulations!"
    where bmi = weight / height ^ 2
</pre>
<p>We put the keyword <span class="fixed">where</span> after the guards (usually it's best to indent it as much as the pipes are indented) and then we define several names or functions. These names are visible across the guards and give us the advantage of not having to repeat ourselves. If we decide that we want to calculate BMI a bit differently, we only have to change it once. It also improves readability by giving names to things and can make our programs faster since stuff like our <span class="fixed">bmi</span> variable here is calculated only once. We could go a bit overboard and present our function like this:</p>
<div class="dp-highlighter nogutter"><div class="bar"></div><ol class="dp-hs" start="1"><li class="alt"><span><span>bmiTell</span><span class="syntax_operators">&nbsp;::&nbsp;</span><span>(</span><span class="type_constructors">RealFloat</span><span>&nbsp;a)</span><span class="syntax_operators">&nbsp;=&gt;&nbsp;</span><span>a</span><span class="syntax_operators">&nbsp;-&gt;&nbsp;</span><span>a</span><span class="syntax_operators">&nbsp;-&gt;&nbsp;</span><span class="type_constructors">String</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>bmiTell&nbsp;weight&nbsp;height&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;<span class="common_operators">&nbsp;|&nbsp;</span><span>bmi</span><span class="common_operators">&nbsp;&lt;=&nbsp;</span><span>skinny</span><span class="common_operators">&nbsp;=&nbsp;</span><span class="string">"You're&nbsp;underweight,&nbsp;you&nbsp;emo,&nbsp;you!"</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;<span class="common_operators">&nbsp;|&nbsp;</span><span>bmi</span><span class="common_operators">&nbsp;&lt;=&nbsp;</span><span>normal</span><span class="common_operators">&nbsp;=&nbsp;</span><span class="string">"You're&nbsp;supposedly&nbsp;normal.&nbsp;Pffft,&nbsp;I&nbsp;bet&nbsp;you're&nbsp;ugly!"</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;<span class="common_operators">&nbsp;|&nbsp;</span><span>bmi</span><span class="common_operators">&nbsp;&lt;=&nbsp;</span><span>fat&nbsp;&nbsp;&nbsp;</span><span class="common_operators">&nbsp;=&nbsp;</span><span class="string">"You're&nbsp;fat!&nbsp;Lose&nbsp;some&nbsp;weight,&nbsp;fatty!"</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;<span class="common_operators">&nbsp;|&nbsp;</span><span>otherwise&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="common_operators">&nbsp;=&nbsp;</span><span class="string">"You're&nbsp;a&nbsp;whale,&nbsp;congratulations!"</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword2">where</span><span>&nbsp;bmi</span><span class="common_operators">&nbsp;=&nbsp;</span><span>weight</span><span class="common_operators">&nbsp;/&nbsp;</span><span>height</span><span class="common_operators">&nbsp;^&nbsp;</span><span class="numbers">2</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skinny<span class="common_operators">&nbsp;=&nbsp;</span><span class="numbers">18.5</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normal<span class="common_operators">&nbsp;=&nbsp;</span><span class="numbers">25.0</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fat<span class="common_operators">&nbsp;=&nbsp;</span><span class="numbers">30.0</span><span>&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="haskell:hs" style="display: none;">bmiTell :: (RealFloat a) =&gt; a -&gt; a -&gt; String
bmiTell weight height
    | bmi &lt;= skinny = "You're underweight, you emo, you!"
    | bmi &lt;= normal = "You're supposedly normal. Pffft, I bet you're ugly!"
    | bmi &lt;= fat    = "You're fat! Lose some weight, fatty!"
    | otherwise     = "You're a whale, congratulations!"
    where bmi = weight / height ^ 2
          skinny = 18.5
          normal = 25.0
          fat = 30.0
</pre>
<p>The names we define in the where section of a function are only visible to that function, so we don't have to worry about them polluting the namespace of other functions. Notice that all the names are aligned at a single column. If we don't align them nice and proper, Haskell gets confused because then it doesn't know they're all part of the same block.</p>
<p><i>where</i> bindings aren't shared across function bodies of different patterns. If you want several patterns of one function to access some shared name, you have to define it globally.</p>
<p>You can also use where bindings to <em>pattern match</em>! We could have rewritten the where section of our previous function as:</p>
<div class="dp-highlighter nogutter"><div class="bar"></div><ol class="dp-hs" start="1"><li class="alt"><span><span>...&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword2">where</span><span>&nbsp;bmi</span><span class="common_operators">&nbsp;=&nbsp;</span><span>weight</span><span class="common_operators">&nbsp;/&nbsp;</span><span>height</span><span class="common_operators">&nbsp;^&nbsp;</span><span class="numbers">2</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(skinny,&nbsp;normal,&nbsp;fat)<span class="common_operators">&nbsp;=&nbsp;</span><span>(</span><span class="numbers">18.5</span><span>,&nbsp;</span><span class="numbers">25.0</span><span>,&nbsp;</span><span class="numbers">30.0</span><span>)&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="haskell:hs" style="display: none;">    ...
    where bmi = weight / height ^ 2
          (skinny, normal, fat) = (18.5, 25.0, 30.0)
</pre>
<p>Let's make another fairly trivial function where we get a first and a last name and give someone back their initials.</p>
<div class="dp-highlighter nogutter"><div class="bar"></div><ol class="dp-hs" start="1"><li class="alt"><span><span>initials</span><span class="syntax_operators">&nbsp;::&nbsp;</span><span class="type_constructors">String</span><span class="syntax_operators">&nbsp;-&gt;&nbsp;</span><span class="type_constructors">String</span><span class="syntax_operators">&nbsp;-&gt;&nbsp;</span><span class="type_constructors">String</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>initials&nbsp;firstname&nbsp;lastname<span class="common_operators">&nbsp;=&nbsp;</span><span>[f]</span><span class="common_operators">&nbsp;++&nbsp;</span><span class="string">".&nbsp;"</span><span class="common_operators">&nbsp;++&nbsp;</span><span>[l]</span><span class="common_operators">&nbsp;++&nbsp;</span><span class="string">"."</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword2">where</span><span>&nbsp;(f:_)</span><span class="common_operators">&nbsp;=&nbsp;</span><span>firstname&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(l:_)<span class="common_operators">&nbsp;=&nbsp;</span><span>lastname&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="haskell:hs" style="display: none;">initials :: String -&gt; String -&gt; String
initials firstname lastname = [f] ++ ". " ++ [l] ++ "."
    where (f:_) = firstname
          (l:_) = lastname  
</pre>
<p>We could have done this pattern matching directly in the function's parameters (it would have been shorter and clearer actually) but this just goes to show that it's possible to do it in where bindings as well.</p>
<p>Just like we've defined constants in where blocks, you can also define functions. Staying true to our healthy programming theme, let's make a function that takes a list of weight-height pairs and returns a list of BMIs.</p>
<div class="dp-highlighter nogutter"><div class="bar"></div><ol class="dp-hs" start="1"><li class="alt"><span><span>calcBmis</span><span class="syntax_operators">&nbsp;::&nbsp;</span><span>(</span><span class="type_constructors">RealFloat</span><span>&nbsp;a)</span><span class="syntax_operators">&nbsp;=&gt;&nbsp;</span><span>[(a,&nbsp;a)]</span><span class="syntax_operators">&nbsp;-&gt;&nbsp;</span><span>[a]&nbsp;&nbsp;</span></span></li><li class=""><span>calcBmis&nbsp;xs<span class="common_operators">&nbsp;=&nbsp;</span><span>[bmi&nbsp;w&nbsp;h</span><span class="common_operators">&nbsp;|&nbsp;</span><span>(w,&nbsp;h)</span><span class="syntax_operators">&nbsp;&lt;-&nbsp;</span><span>xs]&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword2">where</span><span>&nbsp;bmi&nbsp;weight&nbsp;height</span><span class="common_operators">&nbsp;=&nbsp;</span><span>weight</span><span class="common_operators">&nbsp;/&nbsp;</span><span>height</span><span class="common_operators">&nbsp;^&nbsp;</span><span class="numbers">2</span><span>&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="haskell:hs" style="display: none;">calcBmis :: (RealFloat a) =&gt; [(a, a)] -&gt; [a]
calcBmis xs = [bmi w h | (w, h) &lt;- xs]
    where bmi weight height = weight / height ^ 2
</pre>
<p>And that's all there is to it! The reason we had to introduce <span class="fixed">bmi</span> as a function in this example is because we can't just calculate one BMI from the function's parameters. We have to examine the list passed to the function and there's a different BMI for every pair in there.</p>
<p><i>where</i> bindings can also be nested. It's a common idiom to make a function and define some helper function in its <i>where</i> clause and then to give those functions helper functions as well, each with its own <i>where</i> clause.</p>