<body>

<hr>
<h1 data-number="61" id="stdio"><span class="header-section-number">61</span> <code>&lt;stdio.h&gt;</code>
Standard I/O Library</h1>
<table>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="stdio.html#man-feof"><code>clearerr()</code></a></td>
<td>Clear the <code>feof</code> and <code>ferror</code> status
flags</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-fclose"><code>fclose()</code></a></td>
<td>Close an open file</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-feof"><code>feof()</code></a></td>
<td>Return the file end-of-file status</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-feof"><code>ferror()</code></a></td>
<td>Return the file error status</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-fflush"><code>fflush()</code></a></td>
<td>Flush all buffered output to a file</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-getc"><code>fgetc()</code></a></td>
<td>Read a character in a file</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-fgetpos"><code>fgetpos()</code></a></td>
<td>Get the file I/O position</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-gets"><code>fgets()</code></a></td>
<td>Read a line from a file</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-fopen"><code>fopen()</code></a></td>
<td>Open a file</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-printf"><code>fprintf()</code></a></td>
<td>Print formatted output to a file</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-putc"><code>fputc()</code></a></td>
<td>Print a character to a file</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-puts"><code>fputs()</code></a></td>
<td>Print a string to a file</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-fread"><code>fread()</code></a></td>
<td>Read binary data from a file</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-freopen"><code>freopen()</code></a></td>
<td>Change file associated with a stream</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-scanf"><code>fscanf()</code></a></td>
<td>Read formatted input from a file</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-fseek"><code>fseek()</code></a></td>
<td>Set the file I/O position</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-fgetpos"><code>fsetpos()</code></a></td>
<td>Set the file I/O position</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-ftell"><code>ftell()</code></a></td>
<td>Get the file I/O position</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-fwrite"><code>fwrite()</code></a></td>
<td>Write binary data to a file</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-getc"><code>getc()</code></a></td>
<td>Get a character from <code>stdin</code></td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-getc"><code>getchar()</code></a></td>
<td>Get a character from <code>stdin</code></td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-gets"><code>gets()</code></a></td>
<td>Get a string from <code>stdin</code> (removed in C11)</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-perror"><code>perror()</code></a></td>
<td>Print a human-formatted error message</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-printf"><code>printf()</code></a></td>
<td>Print formatted output to <code>stdout</code></td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-putc"><code>putc()</code></a></td>
<td>Print a character to <code>stdout</code></td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-putc"><code>putchar()</code></a></td>
<td>Print a character to <code>stdout</code></td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-puts"><code>puts()</code></a></td>
<td>Print a string to <code>stdout</code></td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-remove"><code>remove()</code></a></td>
<td>Delete a file from disk</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-rename"><code>rename()</code></a></td>
<td>Rename or move a file on disk</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-fseek"><code>rewind()</code></a></td>
<td>Set the I/O position to the beginning of a file</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-scanf"><code>scanf()</code></a></td>
<td>Read formatted input from <code>stdin</code></td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-setbuf"><code>setbuf()</code></a></td>
<td>Configure buffering for I/O operations</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-setbuf"><code>setvbuf()</code></a></td>
<td>Configure buffering for I/O operations</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-printf"><code>snprintf()</code></a></td>
<td>Print length-limited formatted output to a string</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-printf"><code>sprintf()</code></a></td>
<td>Print formatted output to a string</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-scanf"><code>sscanf()</code></a></td>
<td>Read formatted input from a string</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-tmpfile"><code>tmpfile()</code></a></td>
<td>Create a temporary file</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-tmpnam"><code>tmpnam()</code></a></td>
<td>Generate a unique name for a temporary file</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-ungetc"><code>ungetc()</code></a></td>
<td>Push a character back on the input stream</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-vprintf"><code>vfprintf()</code></a></td>
<td>Variadic print formatted output to a file</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-vscanf"><code>vfscanf()</code></a></td>
<td>Variadic read formatted input from a file</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-vprintf"><code>vprintf()</code></a></td>
<td>Variadic print formatted output to <code>stdout</code></td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-vscanf"><code>vscanf()</code></a></td>
<td>Variadic read formatted input from <code>stdin</code></td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-vprintf"><code>vsnprintf()</code></a></td>
<td>Variadic length-limited print formatted output to a string</td>
</tr>
<tr class="odd">
<td><a href="stdio.html#man-vprintf"><code>vsprintf()</code></a></td>
<td>Variadic print formatted output to a string</td>
</tr>
<tr class="even">
<td><a href="stdio.html#man-vscanf"><code>vsscanf()</code></a></td>
<td>Variadic read formatted input to a string</td>
</tr>
</tbody>
</table>
<p>The most basic of all libraries in the whole of the standard C
library is the standard I/O library. It’s used for reading from and
writing to files. I can see you’re very excited about this.</p>
<p>So I’ll continue. It’s also used for reading and writing to the
console, as we’ve already often seen with the <code>printf()</code>
function.</p>
<p>(A little secret here—many many things in various operating systems
are secretly files deep down, and the console is no exception.
“<em>Everything in Unix is a file!</em>” <code>:-)</code>)</p>
<p>You’ll probably want some prototypes of the functions you can use,
right? To get your grubby little mittens on those, you’ll want to
include <code>stdio.h</code>.</p>
<p>Anyway, so we can do all kinds of cool stuff in terms of file I/O.
LIE DETECTED. Ok, ok. We can do all kinds of stuff in terms of file I/O.
Basically, the strategy is this:</p>
<ol type="1">
<li><p>Use <code>fopen()</code> to get a pointer to a file structure of
type <code>FILE*</code>. This pointer is what you’ll be passing to many
of the other file I/O calls.</p></li>
<li><p>Use some of the other file calls, like <code>fscanf()</code>,
<code>fgets()</code>, <code>fprintf()</code>, or etc. using the
<code>FILE*</code> returned from <code>fopen()</code>.</p></li>
<li><p>When done, call <code>fclose()</code> with the
<code>FILE*</code>. This let’s the operating system know that you’re
truly done with the file, no take-backs.</p></li>
</ol>
<p>What’s in the <code>FILE*</code>? Well, as you might guess, it points
to a <code>struct</code> that contains all kinds of information about
the current read and write position in the file, how the file was
opened, and other stuff like that. But, honestly, who cares. No one,
that’s who. The <code>FILE</code> structure is <em>opaque</em> to you as
a programmer; that is, you don’t need to know what’s in it, and you
don’t even <em>want</em> to know what’s in it. You just pass it to the
other standard I/O functions and they know what to do.</p>
<p>This is actually pretty important: try to not muck around in the
<code>FILE</code> structure. It’s not even the same from system to
system, and you’ll end up writing some really non-portable code.</p>
<p>One more thing to mention about the standard I/O library: a lot of
the functions that operate on files use an “f” prefix on the function
name. The same function that is operating on the console will leave the
“f” off. For instance, if you want to print to the console, you use
<code>printf()</code>, but if you want to print to a file, use
<code>fprintf()</code>, see?</p>
<p>Wait a moment! If writing to the console is, deep down, just like
writing to a file, since everything in Unix is a file, why are there two
functions? Answer: it’s more convenient. But, more importantly, is there
a <code>FILE*</code> associated with the console that you can use?
Answer: YES!</p>
<p>There are, in fact, <em>three</em> (count ’em!) special
<code>FILE*</code>s you have at your disposal merely for just including
<code>stdio.h</code>. There is one for input, and two for output.</p>
<p>That hardly seems fair—why does output get two files, and input only
get one?</p>
<p>That’s jumping the gun a bit—let’s just look at them:</p>
<table>
<thead>
<tr class="header">
<th>Stream</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>stdin</code></td>
<td>Input from the console.</td>
</tr>
<tr class="even">
<td><code>stdout</code></td>
<td>Output to the console.</td>
</tr>
<tr class="odd">
<td><code>stderr</code></td>
<td>Output to the console on the error file stream.</td>
</tr>
</tbody>
</table>
<p>So standard input (<code>stdin</code>) is by default just what you
type at the keyboard. You can use that in <code>fscanf()</code> if you
want, just like this:</p>
<div class="sourceCode" id="cb1220"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1220-1"><a href="stdio.html#cb1220-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* this line: */</span></span>
<span id="cb1220-2"><a href="stdio.html#cb1220-2" aria-hidden="true" tabindex="-1"></a>scanf<span class="op">(</span><span class="st">"%d"</span><span class="op">,</span> <span class="op">&amp;</span>x<span class="op">);</span></span>
<span id="cb1220-3"><a href="stdio.html#cb1220-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1220-4"><a href="stdio.html#cb1220-4" aria-hidden="true" tabindex="-1"></a><span class="co">/* is just like this line: */</span></span>
<span id="cb1220-5"><a href="stdio.html#cb1220-5" aria-hidden="true" tabindex="-1"></a>fscanf<span class="op">(</span>stdin<span class="op">,</span> <span class="st">"%d"</span><span class="op">,</span> <span class="op">&amp;</span>x<span class="op">);</span></span></code></pre></div>
<p>And <code>stdout</code> works the same way:</p>
<div class="sourceCode" id="cb1221"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1221-1"><a href="stdio.html#cb1221-1" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"Hello, world!</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1221-2"><a href="stdio.html#cb1221-2" aria-hidden="true" tabindex="-1"></a>fprintf<span class="op">(</span>stdout<span class="op">,</span> <span class="st">"Hello, world!</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span> <span class="co">/* same as previous line! */</span></span></code></pre></div>
<p>So what is this <code>stderr</code> thing? What happens when you
output to that? Well, generally it goes to the console just like
<code>stdout</code>, but people use it for error messages, specifically.
Why? On many systems you can redirect the output from the program into a
file from the command line…and sometimes you’re interested in getting
just the error output. So if the program is good and writes all its
errors to <code>stderr</code>, a user can redirect just
<code>stderr</code> into a file, and just see that. It’s just a nice
thing you, as a programmer, can do.</p>
<p>Finally, a lot of these functions return <code>int</code> where you
might expect <code>char</code>. This is because the function can return
a character <em>or</em> end-of-file (<code>EOF</code>), and
<code>EOF</code> is potentially an integer. If you don’t get
<code>EOF</code> as a return value, you can safely store the result in a
<code>char</code>.</p>
<hr>
<h2 data-number="61.1" id="man-remove"><span class="header-section-number">61.1</span> <code>remove()</code></h2>
<p>Delete a file</p>
<h3 class="unnumbered unlisted" id="synopsis-135">Synopsis</h3>
<div class="sourceCode" id="cb1222"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1222-1"><a href="stdio.html#cb1222-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1222-2"><a href="stdio.html#cb1222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1222-3"><a href="stdio.html#cb1222-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> remove<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>filename<span class="op">);</span> </span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-135">Description</h3>
<p>Removes the specified file from the filesystem. It just deletes it.
Nothing magical. Simply call this function and sacrifice a small chicken
and the requested file will be deleted.</p>
<h3 class="unnumbered unlisted" id="return-value-133">Return Value</h3>
<p>Returns zero on success, and <code>-1</code> on error, setting
<code>errno</code>.</p>
<h3 class="unnumbered unlisted" id="example-136">Example</h3>
<div class="sourceCode" id="cb1223"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1223-1"><a href="stdio.html#cb1223-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1223-2"><a href="stdio.html#cb1223-2"></a></span>
<span id="cb1223-3"><a href="stdio.html#cb1223-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1223-4"><a href="stdio.html#cb1223-4"></a><span class="op">{</span></span>
<span id="cb1223-5"><a href="stdio.html#cb1223-5"></a>    <span class="dt">char</span> <span class="op">*</span>filename <span class="op">=</span> <span class="st">"evidence.txt"</span><span class="op">;</span></span>
<span id="cb1223-6"><a href="stdio.html#cb1223-6"></a></span>
<span id="cb1223-7"><a href="stdio.html#cb1223-7"></a>    remove<span class="op">(</span>filename<span class="op">);</span></span>
<span id="cb1223-8"><a href="stdio.html#cb1223-8"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-127">See Also</h3>
<p><a href="stdio.html#man-rename"><code>rename()</code></a></p>
<hr>
<h2 data-number="61.2" id="man-rename"><span class="header-section-number">61.2</span> <code>rename()</code></h2>
<p>Renames a file and optionally moves it to a new location</p>
<h3 class="unnumbered unlisted" id="synopsis-136">Synopsis</h3>
<div class="sourceCode" id="cb1224"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1224-1"><a href="stdio.html#cb1224-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1224-2"><a href="stdio.html#cb1224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1224-3"><a href="stdio.html#cb1224-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> rename<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>old<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>new<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-136">Description</h3>
<p>Renames the file <code>old</code> to name <code>new</code>. Use this
function if you’re tired of the old name of the file, and you are ready
for a change. Sometimes simply renaming your files makes them feel new
again, and could save you money over just getting all new files!</p>
<p>One other cool thing you can do with this function is actually move a
file from one directory to another by specifying a different path for
the new name.</p>
<h3 class="unnumbered unlisted" id="return-value-134">Return Value</h3>
<p>Returns zero on success, and <code>-1</code> on error, setting
<code>errno</code>.</p>
<h3 class="unnumbered unlisted" id="example-137">Example</h3>
<div class="sourceCode" id="cb1225"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1225-1"><a href="stdio.html#cb1225-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1225-2"><a href="stdio.html#cb1225-2"></a></span>
<span id="cb1225-3"><a href="stdio.html#cb1225-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1225-4"><a href="stdio.html#cb1225-4"></a><span class="op">{</span></span>
<span id="cb1225-5"><a href="stdio.html#cb1225-5"></a>    <span class="co">// Rename a file</span></span>
<span id="cb1225-6"><a href="stdio.html#cb1225-6"></a>    rename<span class="op">(</span><span class="st">"foo"</span><span class="op">,</span> <span class="st">"bar"</span><span class="op">);</span></span>
<span id="cb1225-7"><a href="stdio.html#cb1225-7"></a></span>
<span id="cb1225-8"><a href="stdio.html#cb1225-8"></a>    <span class="co">// Rename and move to another directory:</span></span>
<span id="cb1225-9"><a href="stdio.html#cb1225-9"></a>    rename<span class="op">(</span><span class="st">"/home/beej/evidence.txt"</span><span class="op">,</span> <span class="st">"/tmp/nothing.txt"</span><span class="op">);</span></span>
<span id="cb1225-10"><a href="stdio.html#cb1225-10"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-128">See Also</h3>
<p><a href="stdio.html#man-remove"><code>remove()</code></a></p>
<hr>
<h2 data-number="61.3" id="man-tmpfile"><span class="header-section-number">61.3</span> <code>tmpfile()</code></h2>
<p>Create a temporary file</p>
<h3 class="unnumbered unlisted" id="synopsis-137">Synopsis</h3>
<div class="sourceCode" id="cb1226"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1226-1"><a href="stdio.html#cb1226-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1226-2"><a href="stdio.html#cb1226-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1226-3"><a href="stdio.html#cb1226-3" aria-hidden="true" tabindex="-1"></a><span class="dt">FILE</span> <span class="op">*</span>tmpfile<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-137">Description</h3>
<p>This is a nifty little function that will create and open a temporary
file for you, and will return a <code>FILE*</code> to it that you can
use. The file is opened with mode “<code>r+b</code>”, so it’s suitable
for reading, writing, and binary data.</p>
<p>By using a little magic, the temp file is automatically deleted when
it is <code>close()</code>’d or when your program exits. (Specifically,
in Unix terms, <code>tmpfile()</code> <a href="https://man.archlinux.org/man/unlinkat.2.en#DESCRIPTION"><em>unlinks</em></a><a href="#fn253" class="footnote-ref" id="fnref253" role="doc-noteref"><sup>253</sup></a> the file right after it opens it.
This means that it’s primed to be deleted from disk, but still exists
because your process still has it open. As soon as your process exits,
all open files are closed, and the temp file vanishes into the
ether.)</p>
<h3 class="unnumbered unlisted" id="return-value-135">Return Value</h3>
<p>This function returns an open <code>FILE*</code> on success, or
<code>NULL</code> on failure.</p>
<h3 class="unnumbered unlisted" id="example-138">Example</h3>
<div class="sourceCode" id="cb1227"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1227-1"><a href="stdio.html#cb1227-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1227-2"><a href="stdio.html#cb1227-2"></a></span>
<span id="cb1227-3"><a href="stdio.html#cb1227-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1227-4"><a href="stdio.html#cb1227-4"></a><span class="op">{</span></span>
<span id="cb1227-5"><a href="stdio.html#cb1227-5"></a>    <span class="dt">FILE</span> <span class="op">*</span>temp<span class="op">;</span></span>
<span id="cb1227-6"><a href="stdio.html#cb1227-6"></a>    <span class="dt">char</span> s<span class="op">[</span><span class="dv">128</span><span class="op">];</span></span>
<span id="cb1227-7"><a href="stdio.html#cb1227-7"></a></span>
<span id="cb1227-8"><a href="stdio.html#cb1227-8"></a>    temp <span class="op">=</span> tmpfile<span class="op">();</span></span>
<span id="cb1227-9"><a href="stdio.html#cb1227-9"></a></span>
<span id="cb1227-10"><a href="stdio.html#cb1227-10"></a>    fprintf<span class="op">(</span>temp<span class="op">,</span> <span class="st">"What is the frequency, Alexander?</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1227-11"><a href="stdio.html#cb1227-11"></a></span>
<span id="cb1227-12"><a href="stdio.html#cb1227-12"></a>    rewind<span class="op">(</span>temp<span class="op">);</span> <span class="co">// back to the beginning</span></span>
<span id="cb1227-13"><a href="stdio.html#cb1227-13"></a></span>
<span id="cb1227-14"><a href="stdio.html#cb1227-14"></a>    fscanf<span class="op">(</span>temp<span class="op">,</span> <span class="st">"%s"</span><span class="op">,</span> s<span class="op">);</span> <span class="co">// read it back out</span></span>
<span id="cb1227-15"><a href="stdio.html#cb1227-15"></a></span>
<span id="cb1227-16"><a href="stdio.html#cb1227-16"></a>    fclose<span class="op">(</span>temp<span class="op">);</span> <span class="co">// close (and magically delete)</span></span>
<span id="cb1227-17"><a href="stdio.html#cb1227-17"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-129">See Also</h3>
<p><a href="stdio.html#man-fopen"><code>fopen()</code></a>, <a href="#man-fclose"><code>fclose()</code></a>, <a href="#man-tmpnam"><code>tmpnam()</code></a></p>
<hr>
<h2 data-number="61.4" id="man-tmpnam"><span class="header-section-number">61.4</span> <code>tmpnam()</code></h2>
<p>Generate a unique name for a temporary file</p>
<h3 class="unnumbered unlisted" id="synopsis-138">Synopsis</h3>
<div class="sourceCode" id="cb1228"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1228-1"><a href="stdio.html#cb1228-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1228-2"><a href="stdio.html#cb1228-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1228-3"><a href="stdio.html#cb1228-3" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> <span class="op">*</span>tmpnam<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>s<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-138">Description</h3>
<p>This function takes a good hard look at the existing files on your
system, and comes up with a unique name for a new file that is suitable
for temporary file usage.</p>
<p>Let’s say you have a program that needs to store off some data for a
short time so you create a temporary file for the data, to be deleted
when the program is done running. Now imagine that you called this file
<code>foo.txt</code>. This is all well and good, except what if a user
already has a file called <code>foo.txt</code> in the directory that you
ran your program from? You’d overwrite their file, and they’d be unhappy
and stalk you forever. And you wouldn’t want that, now would you?</p>
<p>Ok, so you get wise, and you decide to put the file in
<code>/tmp</code> so that it won’t overwrite any important content. But
wait! What if some other user is running your program at the same time
and they both want to use that filename? Or what if some other program
has already created that file?</p>
<p>See, all of these scary problems can be completely avoided if you
just use <code>tmpnam()</code> to get a safe-ready-to-use filename.</p>
<p>So how do you use it? There are two amazing ways. One, you can
declare an array (or <code>malloc()</code> it—whatever) that is big
enough to hold the temporary file name. How big is that? Fortunately
there has been a macro defined for you, <code>L_tmpnam</code>, which is
how big the array must be.</p>
<p>And the second way: just pass <code>NULL</code> for the filename.
<code>tmpnam()</code> will store the temporary name in a static array
and return a pointer to that. Subsequent calls with a <code>NULL</code>
argument will overwrite the static array, so be sure you’re done using
it before you call <code>tmpnam()</code> again.</p>
<p>Again, this function just makes a file name for you. It’s up to you
to later <code>fopen()</code> the file and use it.</p>
<p>One more note: some compilers warn against using
<code>tmpnam()</code> since some systems have better functions (like the
Unix function <code>mkstemp()</code>.) You might want to check your
local documentation to see if there’s a better option. Linux
documentation goes so far as to say, “Never use this function. Use
<code>mkstemp()</code> instead.”</p>
<p>I, however, am going to be a jerk and not talk about <a href="https://man.archlinux.org/man/mkstemp.3.en"><code>mkstemp()</code></a><a href="#fn254" class="footnote-ref" id="fnref254" role="doc-noteref"><sup>254</sup></a> because it’s not in the standard
I’m writing about. Nyaah.</p>
<p>The macro <code>TMP_MAX</code> holds the number of unique filenames
that can be generated by <code>tmpnam()</code>. Ironically, it is the
<em>minimum</em> number of such filenames.</p>
<h3 class="unnumbered unlisted" id="return-value-136">Return Value</h3>
<p>Returns a pointer to the temporary file name. This is either a
pointer to the string you passed in, or a pointer to internal static
storage if you passed in <code>NULL</code>. On error (like it can’t find
any temporary name that is unique), <code>tmpnam()</code> returns
<code>NULL</code>.</p>
<h3 class="unnumbered unlisted" id="example-139">Example</h3>
<div class="sourceCode" id="cb1229"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1229-1"><a href="stdio.html#cb1229-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1229-2"><a href="stdio.html#cb1229-2"></a></span>
<span id="cb1229-3"><a href="stdio.html#cb1229-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1229-4"><a href="stdio.html#cb1229-4"></a><span class="op">{</span></span>
<span id="cb1229-5"><a href="stdio.html#cb1229-5"></a>    <span class="dt">char</span> filename<span class="op">[</span>L_tmpnam<span class="op">];</span></span>
<span id="cb1229-6"><a href="stdio.html#cb1229-6"></a>    <span class="dt">char</span> <span class="op">*</span>another_filename<span class="op">;</span></span>
<span id="cb1229-7"><a href="stdio.html#cb1229-7"></a></span>
<span id="cb1229-8"><a href="stdio.html#cb1229-8"></a>    <span class="cf">if</span> <span class="op">(</span>tmpnam<span class="op">(</span>filename<span class="op">)</span> <span class="op">!=</span> NULL<span class="op">)</span></span>
<span id="cb1229-9"><a href="stdio.html#cb1229-9"></a>        printf<span class="op">(</span><span class="st">"We got a temp file name: </span><span class="sc">\"</span><span class="st">%s</span><span class="sc">\"\n</span><span class="st">"</span><span class="op">,</span> filename<span class="op">);</span></span>
<span id="cb1229-10"><a href="stdio.html#cb1229-10"></a>    <span class="cf">else</span></span>
<span id="cb1229-11"><a href="stdio.html#cb1229-11"></a>        printf<span class="op">(</span><span class="st">"Something went wrong, and we got nothing!</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1229-12"><a href="stdio.html#cb1229-12"></a></span>
<span id="cb1229-13"><a href="stdio.html#cb1229-13"></a>    another_filename <span class="op">=</span> tmpnam<span class="op">(</span>NULL<span class="op">);</span></span>
<span id="cb1229-14"><a href="stdio.html#cb1229-14"></a></span>
<span id="cb1229-15"><a href="stdio.html#cb1229-15"></a>    printf<span class="op">(</span><span class="st">"We got another temp file name: </span><span class="sc">\"</span><span class="st">%s</span><span class="sc">\"\n</span><span class="st">"</span><span class="op">,</span> another_filename<span class="op">);</span></span>
<span id="cb1229-16"><a href="stdio.html#cb1229-16"></a>    printf<span class="op">(</span><span class="st">"And we didn't error check it because we're too lazy!</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1229-17"><a href="stdio.html#cb1229-17"></a><span class="op">}</span></span></code></pre></div>
<p>On my Linux system, this generates the following output:</p>
<pre><code>We got a temp file name: "/tmp/filew9PMuZ"
We got another temp file name: "/tmp/fileOwrgPO"
And we didn't error check it because we're too lazy!</code></pre>
<h3 class="unnumbered unlisted" id="see-also-130">See Also</h3>
<p><a href="stdio.html#man-fopen"><code>fopen()</code></a>, <a href="#man-tmpfile"><code>tmpfile()</code></a></p>
<hr>
<h2 data-number="61.5" id="man-fclose"><span class="header-section-number">61.5</span> <code>fclose()</code></h2>
<p>The opposite of <code>fopen()</code>—closes a file when you’re done
with it so that it frees system resources</p>
<h3 class="unnumbered unlisted" id="synopsis-139">Synopsis</h3>
<div class="sourceCode" id="cb1231"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1231-1"><a href="stdio.html#cb1231-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1231-2"><a href="stdio.html#cb1231-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1231-3"><a href="stdio.html#cb1231-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fclose<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-139">Description</h3>
<p>When you open a file, the system sets aside some resources to
maintain information about that open file. Usually it can only open so
many files at once. In any case, the Right Thing to do is to close your
files when you’re done using them so that the system resources are
freed.</p>
<p>Also, you might not find that all the information that you’ve written
to the file has actually been written to disk until the file is closed.
(You can force this with a call to <code>fflush()</code>.)</p>
<p>When your program exits normally, it closes all open files for you.
Lots of times, though, you’ll have a long-running program, and it’d be
better to close the files before then. In any case, not closing a file
you’ve opened makes you look bad. So, remember to <code>fclose()</code>
your file when you’re done with it!</p>
<h3 class="unnumbered unlisted" id="return-value-137">Return Value</h3>
<p>On success, <code>0</code> is returned. Typically no one checks for
this. On error <code>EOF</code> is returned. Typically no one checks for
this, either.</p>
<h3 class="unnumbered unlisted" id="example-140">Example</h3>
<div class="sourceCode" id="cb1232"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1232-1"><a href="stdio.html#cb1232-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1232-2"><a href="stdio.html#cb1232-2"></a></span>
<span id="cb1232-3"><a href="stdio.html#cb1232-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1232-4"><a href="stdio.html#cb1232-4"></a><span class="op">{</span></span>
<span id="cb1232-5"><a href="stdio.html#cb1232-5"></a>    <span class="dt">FILE</span> <span class="op">*</span>fp<span class="op">;</span></span>
<span id="cb1232-6"><a href="stdio.html#cb1232-6"></a></span>
<span id="cb1232-7"><a href="stdio.html#cb1232-7"></a>    fp <span class="op">=</span> fopen<span class="op">(</span><span class="st">"spoon.txt"</span><span class="op">,</span> <span class="st">"r"</span><span class="op">);</span></span>
<span id="cb1232-8"><a href="stdio.html#cb1232-8"></a></span>
<span id="cb1232-9"><a href="stdio.html#cb1232-9"></a>    <span class="cf">if</span> <span class="op">(</span>fp <span class="op">==</span> NULL<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1232-10"><a href="stdio.html#cb1232-10"></a>        printf<span class="op">(</span><span class="st">"Error opening file</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1232-11"><a href="stdio.html#cb1232-11"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb1232-12"><a href="stdio.html#cb1232-12"></a>        printf<span class="op">(</span><span class="st">"Opened file just fine!</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1232-13"><a href="stdio.html#cb1232-13"></a>        fclose<span class="op">(</span>fp<span class="op">);</span>  <span class="co">// All done!</span></span>
<span id="cb1232-14"><a href="stdio.html#cb1232-14"></a>    <span class="op">}</span></span>
<span id="cb1232-15"><a href="stdio.html#cb1232-15"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-131">See Also</h3>
<p><a href="stdio.html#man-fopen"><code>fopen()</code></a></p>
<hr>
<h2 data-number="61.6" id="man-fflush"><span class="header-section-number">61.6</span> <code>fflush()</code></h2>
<p>Process all buffered I/O for a stream right now</p>
<h3 class="unnumbered unlisted" id="synopsis-140">Synopsis</h3>
<div class="sourceCode" id="cb1233"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1233-1"><a href="stdio.html#cb1233-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1233-2"><a href="stdio.html#cb1233-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1233-3"><a href="stdio.html#cb1233-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fflush<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-140">Description</h3>
<p>When you do standard I/O, as mentioned in the section on the <a href="#man-setbuf"><code>setvbuf()</code></a> function, it is usually
stored in a buffer until a line has been entered or the buffer is full
or the file is closed. Sometimes, though, you really want the output to
happen <em>right this second</em>, and not wait around in the buffer.
You can force this to happen by calling <code>fflush()</code>.</p>
<p>The advantage to buffering is that the OS doesn’t need to hit the
disk every time you call <code>fprintf()</code>. The disadvantage is
that if you look at the file on the disk after the
<code>fprintf()</code> call, it might not have actually been written to
yet. (“I called <code>fputs()</code>, but the file is still zero bytes
long! Why?!”) In virtually all circumstances, the advantages of
buffering outweigh the disadvantages; for those other circumstances,
however, use <code>fflush()</code>.</p>
<p>Note that <code>fflush()</code> is only designed to work on output
streams according to the spec. What will happen if you try it on an
input stream? Use your spooky voice: <em>who knooooows!</em></p>
<h3 class="unnumbered unlisted" id="return-value-138">Return Value</h3>
<p>On success, <code>fflush()</code> returns zero. If there’s an error,
it returns <code>EOF</code> and sets the error condition for the stream
(see <a href="stdio.html#man-feof"><code>ferror()</code></a>.)</p>
<h3 class="unnumbered unlisted" id="example-141">Example</h3>
<p>In this example, we’re going to use the carriage return, which is
<code>'\r'</code>. This is like newline (<code>'\n'</code>), except that
it doesn’t move to the next line. It just returns to the front of the
current line.</p>
<p>What we’re going to do is a little text-based status bar like so many
command line programs implement. It’ll do a countdown from 10 to 0
printing over itself on the same line.</p>
<p>What is the catch and what does this have to do with
<code>fflush()</code>? The catch is that the terminal is most likely
“line buffered” (see the section on <a href="#man-setbuf"><code>setvbuf()</code></a> for more info), meaning
that it won’t actually display anything until it prints a newline. But
we’re not printing newlines; we’re just printing carriage returns, so we
need a way to force the output to occur even though we’re on the same
line. Yes, it’s <code>fflush()!</code></p>
<div class="sourceCode" id="cb1234"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1234-1"><a href="stdio.html#cb1234-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1234-2"><a href="stdio.html#cb1234-2"></a><span class="pp">#include </span><span class="im">&lt;threads.h&gt;</span></span>
<span id="cb1234-3"><a href="stdio.html#cb1234-3"></a></span>
<span id="cb1234-4"><a href="stdio.html#cb1234-4"></a><span class="dt">void</span> sleep_seconds<span class="op">(</span><span class="dt">int</span> s<span class="op">)</span></span>
<span id="cb1234-5"><a href="stdio.html#cb1234-5"></a><span class="op">{</span></span>
<span id="cb1234-6"><a href="stdio.html#cb1234-6"></a>    thrd_sleep<span class="op">(&amp;(</span><span class="kw">struct</span> timespec<span class="op">){.</span>tv_sec<span class="op">=</span>s<span class="op">},</span> NULL<span class="op">);</span></span>
<span id="cb1234-7"><a href="stdio.html#cb1234-7"></a><span class="op">}</span></span>
<span id="cb1234-8"><a href="stdio.html#cb1234-8"></a></span>
<span id="cb1234-9"><a href="stdio.html#cb1234-9"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1234-10"><a href="stdio.html#cb1234-10"></a><span class="op">{</span></span>
<span id="cb1234-11"><a href="stdio.html#cb1234-11"></a>    <span class="dt">int</span> count<span class="op">;</span></span>
<span id="cb1234-12"><a href="stdio.html#cb1234-12"></a></span>
<span id="cb1234-13"><a href="stdio.html#cb1234-13"></a>    <span class="cf">for</span><span class="op">(</span>count <span class="op">=</span> <span class="dv">10</span><span class="op">;</span> count <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> count<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb1234-14"><a href="stdio.html#cb1234-14"></a>        printf<span class="op">(</span><span class="st">"</span><span class="sc">\r</span><span class="st">Seconds until launch: "</span><span class="op">);</span>  <span class="co">// lead with a CR</span></span>
<span id="cb1234-15"><a href="stdio.html#cb1234-15"></a>        <span class="cf">if</span> <span class="op">(</span>count <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb1234-16"><a href="stdio.html#cb1234-16"></a>            printf<span class="op">(</span><span class="st">"%2d"</span><span class="op">,</span> count<span class="op">);</span></span>
<span id="cb1234-17"><a href="stdio.html#cb1234-17"></a>        <span class="cf">else</span></span>
<span id="cb1234-18"><a href="stdio.html#cb1234-18"></a>            printf<span class="op">(</span><span class="st">"blastoff!</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1234-19"><a href="stdio.html#cb1234-19"></a></span>
<span id="cb1234-20"><a href="stdio.html#cb1234-20"></a>        <span class="co">// force output now!!</span></span>
<span id="cb1234-21"><a href="stdio.html#cb1234-21"></a>        fflush<span class="op">(</span>stdout<span class="op">);</span></span>
<span id="cb1234-22"><a href="stdio.html#cb1234-22"></a></span>
<span id="cb1234-23"><a href="stdio.html#cb1234-23"></a>        sleep_seconds<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb1234-24"><a href="stdio.html#cb1234-24"></a>    <span class="op">}</span></span>
<span id="cb1234-25"><a href="stdio.html#cb1234-25"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-132">See Also</h3>
<p><a href="stdio.html#man-setbuf"><code>setbuf()</code></a>, <a href="#man-setbuf"><code>setvbuf()</code></a></p>
<hr>
<h2 data-number="61.7" id="man-fopen"><span class="header-section-number">61.7</span> <code>fopen()</code></h2>
<p>Opens a file for reading or writing</p>
<h3 class="unnumbered unlisted" id="synopsis-141">Synopsis</h3>
<div class="sourceCode" id="cb1235"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1235-1"><a href="stdio.html#cb1235-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1235-2"><a href="stdio.html#cb1235-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1235-3"><a href="stdio.html#cb1235-3" aria-hidden="true" tabindex="-1"></a><span class="dt">FILE</span> <span class="op">*</span>fopen<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>path<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>mode<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-141">Description</h3>
<p>The <code>fopen()</code> opens a file for reading or writing.</p>
<p>Parameter <code>path</code> can be a relative or fully-qualified path
and file name to the file in question.</p>
<p>Parameter <code>mode</code> tells <code>fopen()</code> how to open
the file (reading, writing, or both), and whether or not it’s a binary
file. Possible modes are:</p>
<table>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Mode</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>r</code></td>
<td>Open the file for reading (read-only).</td>
</tr>
<tr class="even">
<td><code>w</code></td>
<td>Open the file for writing (write-only). The file is created if it
doesn’t exist.</td>
</tr>
<tr class="odd">
<td><code>r+</code></td>
<td>Open the file for reading and writing. The file has to already
exist.</td>
</tr>
<tr class="even">
<td><code>w+</code></td>
<td>Open the file for writing and reading. The file is created if it
doesn’t already exist.</td>
</tr>
<tr class="odd">
<td><code>a</code></td>
<td>Open the file for append. This is just like opening a file for
writing, but it positions the file pointer at the end of the file, so
the next write appends to the end. The file is created if it doesn’t
exist.</td>
</tr>
<tr class="even">
<td><code>a+</code></td>
<td>Open the file for reading and appending. The file is created if it
doesn’t exist.</td>
</tr>
</tbody>
</table>
<p>Any of the modes can have the letter “<code>b</code>” appended to the
end, as is “<code>wb</code>” (“write binary”), to signify that the file
in question is a <em>binary</em> file. (“Binary” in this case generally
means that the file contains non-alphanumeric characters that look like
garbage to human eyes.) Many systems (like Unix) don’t differentiate
between binary and non-binary files, so the “<code>b</code>” is
extraneous. But if your data is binary, it doesn’t hurt to throw the
“<code>b</code>” in there, and it might help someone who is trying to
port your code to another system.</p>
<p>The macro <code>FOPEN_MAX</code> tells you how many streams (at
least) you can have open at once.</p>
<p>The macro <code>FILENAME_MAX</code> tells you what the longest valid
filename can be. Don’t go crazy, now.</p>
<h3 class="unnumbered unlisted" id="return-value-139">Return Value</h3>
<p><code>fopen()</code> returns a <code>FILE*</code> that can be used in
subsequent file-related calls.</p>
<p>If something goes wrong (e.g.&nbsp;you tried to open a file for read that
didn’t exist), <code>fopen()</code> will return <code>NULL</code>.</p>
<h3 class="unnumbered unlisted" id="example-142">Example</h3>
<div class="sourceCode" id="cb1236"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1236-1"><a href="stdio.html#cb1236-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1236-2"><a href="stdio.html#cb1236-2"></a></span>
<span id="cb1236-3"><a href="stdio.html#cb1236-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1236-4"><a href="stdio.html#cb1236-4"></a><span class="op">{</span></span>
<span id="cb1236-5"><a href="stdio.html#cb1236-5"></a>    <span class="dt">FILE</span> <span class="op">*</span>fp<span class="op">;</span></span>
<span id="cb1236-6"><a href="stdio.html#cb1236-6"></a></span>
<span id="cb1236-7"><a href="stdio.html#cb1236-7"></a>    fp <span class="op">=</span> fopen<span class="op">(</span><span class="st">"spoon.txt"</span><span class="op">,</span> <span class="st">"r"</span><span class="op">);</span></span>
<span id="cb1236-8"><a href="stdio.html#cb1236-8"></a></span>
<span id="cb1236-9"><a href="stdio.html#cb1236-9"></a>    <span class="cf">if</span> <span class="op">(</span>fp <span class="op">==</span> NULL<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1236-10"><a href="stdio.html#cb1236-10"></a>        printf<span class="op">(</span><span class="st">"Error opening file</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1236-11"><a href="stdio.html#cb1236-11"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb1236-12"><a href="stdio.html#cb1236-12"></a>        printf<span class="op">(</span><span class="st">"Opened file just fine!</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1236-13"><a href="stdio.html#cb1236-13"></a>        fclose<span class="op">(</span>fp<span class="op">);</span>  <span class="co">// All done!</span></span>
<span id="cb1236-14"><a href="stdio.html#cb1236-14"></a>    <span class="op">}</span></span>
<span id="cb1236-15"><a href="stdio.html#cb1236-15"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-133">See Also</h3>
<p><a href="stdio.html#man-fclose"><code>fclose()</code></a>, <a href="#man-freopen"><code>freopen()</code></a></p>
<hr>
<h2 data-number="61.8" id="man-freopen"><span class="header-section-number">61.8</span> <code>freopen()</code></h2>
<p>Reopen an existing <code>FILE*</code>, associating it with a new
path</p>
<h3 class="unnumbered unlisted" id="synopsis-142">Synopsis</h3>
<div class="sourceCode" id="cb1237"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1237-1"><a href="stdio.html#cb1237-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1237-2"><a href="stdio.html#cb1237-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1237-3"><a href="stdio.html#cb1237-3" aria-hidden="true" tabindex="-1"></a><span class="dt">FILE</span> <span class="op">*</span>freopen<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>filename<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>mode<span class="op">,</span> <span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-142">Description</h3>
<p>Let’s say you have an existing <code>FILE*</code> stream that’s
already open, but you want it to suddenly use a different file than the
one it’s using. You can use <code>freopen()</code> to “re-open” the
stream with a new file.</p>
<p>Why on Earth would you ever want to do that? Well, the most common
reason would be if you had a program that normally would read from
<code>stdin</code>, but instead you wanted it to read from a file.
Instead of changing all your <code>scanf()</code>s to
<code>fscanf()</code>s, you could simply reopen <code>stdin</code> on
the file you wanted to read from.</p>
<p>Another usage that is allowed on some systems is that you can pass
<code>NULL</code> for <code>filename</code>, and specify a new
<code>mode</code> for <code>stream</code>. So you could change a file
from “<code>r+</code>” (read and write) to just “<code>r</code>” (read),
for instance. It’s implementation dependent which modes can be
changed.</p>
<p>When you call <code>freopen()</code>, the old <code>stream</code> is
closed. Otherwise, the function behaves just like the standard
<code>fopen()</code>.</p>
<h3 class="unnumbered unlisted" id="return-value-140">Return Value</h3>
<p><code>freopen()</code> returns <code>stream</code> if all goes
well.</p>
<p>If something goes wrong (e.g.&nbsp;you tried to open a file for read that
didn’t exist), <code>freopen()</code> will return <code>NULL</code>.</p>
<h3 class="unnumbered unlisted" id="example-143">Example</h3>
<div class="sourceCode" id="cb1238"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1238-1"><a href="stdio.html#cb1238-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1238-2"><a href="stdio.html#cb1238-2"></a></span>
<span id="cb1238-3"><a href="stdio.html#cb1238-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1238-4"><a href="stdio.html#cb1238-4"></a><span class="op">{</span></span>
<span id="cb1238-5"><a href="stdio.html#cb1238-5"></a>    <span class="dt">int</span> i<span class="op">,</span> i2<span class="op">;</span></span>
<span id="cb1238-6"><a href="stdio.html#cb1238-6"></a></span>
<span id="cb1238-7"><a href="stdio.html#cb1238-7"></a>    scanf<span class="op">(</span><span class="st">"%d"</span><span class="op">,</span> <span class="op">&amp;</span>i<span class="op">);</span> <span class="co">// read i from stdin</span></span>
<span id="cb1238-8"><a href="stdio.html#cb1238-8"></a></span>
<span id="cb1238-9"><a href="stdio.html#cb1238-9"></a>    <span class="co">// now change stdin to refer to a file instead of the keyboard</span></span>
<span id="cb1238-10"><a href="stdio.html#cb1238-10"></a>    freopen<span class="op">(</span><span class="st">"someints.txt"</span><span class="op">,</span> <span class="st">"r"</span><span class="op">,</span> stdin<span class="op">);</span></span>
<span id="cb1238-11"><a href="stdio.html#cb1238-11"></a></span>
<span id="cb1238-12"><a href="stdio.html#cb1238-12"></a>    scanf<span class="op">(</span><span class="st">"%d"</span><span class="op">,</span> <span class="op">&amp;</span>i2<span class="op">);</span> <span class="co">// now this reads from the file "someints.txt"</span></span>
<span id="cb1238-13"><a href="stdio.html#cb1238-13"></a></span>
<span id="cb1238-14"><a href="stdio.html#cb1238-14"></a>    printf<span class="op">(</span><span class="st">"Hello, world!</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span> <span class="co">// print to the screen</span></span>
<span id="cb1238-15"><a href="stdio.html#cb1238-15"></a></span>
<span id="cb1238-16"><a href="stdio.html#cb1238-16"></a>    <span class="co">// change stdout to go to a file instead of the terminal:</span></span>
<span id="cb1238-17"><a href="stdio.html#cb1238-17"></a>    freopen<span class="op">(</span><span class="st">"output.txt"</span><span class="op">,</span> <span class="st">"w"</span><span class="op">,</span> stdout<span class="op">);</span></span>
<span id="cb1238-18"><a href="stdio.html#cb1238-18"></a></span>
<span id="cb1238-19"><a href="stdio.html#cb1238-19"></a>    printf<span class="op">(</span><span class="st">"This goes to the file </span><span class="sc">\"</span><span class="st">output.txt</span><span class="sc">\"\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1238-20"><a href="stdio.html#cb1238-20"></a></span>
<span id="cb1238-21"><a href="stdio.html#cb1238-21"></a>    <span class="co">// this is allowed on some systems--you can change the mode of a file:</span></span>
<span id="cb1238-22"><a href="stdio.html#cb1238-22"></a>    freopen<span class="op">(</span>NULL<span class="op">,</span> <span class="st">"wb"</span><span class="op">,</span> stdout<span class="op">);</span> <span class="co">// change to "wb" instead of "w"</span></span>
<span id="cb1238-23"><a href="stdio.html#cb1238-23"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-134">See Also</h3>
<p><a href="stdio.html#man-fclose"><code>fclose()</code></a>, <a href="#man-fopen"><code>fopen()</code></a></p>
<hr>
<h2 data-number="61.9" id="man-setbuf"><span class="header-section-number">61.9</span> <code>setbuf()</code>,
<code>setvbuf()</code></h2>
<p>Configure buffering for standard I/O operations</p>
<h3 class="unnumbered unlisted" id="synopsis-143">Synopsis</h3>
<div class="sourceCode" id="cb1239"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1239-1"><a href="stdio.html#cb1239-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1239-2"><a href="stdio.html#cb1239-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1239-3"><a href="stdio.html#cb1239-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setbuf<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>buf<span class="op">);</span></span>
<span id="cb1239-4"><a href="stdio.html#cb1239-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1239-5"><a href="stdio.html#cb1239-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> setvbuf<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>buf<span class="op">,</span> <span class="dt">int</span> mode<span class="op">,</span> <span class="dt">size_t</span> size<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-143">Description</h3>
<p>Now brace yourself because this might come as a bit of a surprise to
you: when you <code>printf()</code> or <code>fprintf()</code> or use any
I/O functions like that, <em>it does not normally work immediately</em>.
For the sake of efficiency, and to irritate you, the I/O on a
<code>FILE*</code> stream is buffered away safely until certain
conditions are met, and only then is the actual I/O performed. The
functions <code>setbuf()</code> and <code>setvbuf()</code> allow you to
change those conditions and the buffering behavior.</p>
<p>So what are the different buffering behaviors? The biggest is called
“full buffering”, wherein all I/O is stored in a big buffer until it is
full, and then it is dumped out to disk (or whatever the file is). The
next biggest is called “line buffering”; with line buffering, I/O is
stored up a line at a time (until a newline (<code>'\n'</code>)
character is encountered) and then that line is processed. Finally, we
have “unbuffered”, which means I/O is processed immediately with every
standard I/O call.</p>
<p>You might have seen and wondered why you could call
<code>putchar()</code> time and time again and not see any output until
you called <code>putchar('\n')</code>; that’s right—<code>stdout</code>
is line-buffered!</p>
<p>Since <code>setbuf()</code> is just a simplified version of
<code>setvbuf()</code>, we’ll talk about <code>setvbuf()</code>
first.</p>
<p>The <code>stream</code> is the <code>FILE*</code> you wish to modify.
The standard says you <em>must</em> make your call to
<code>setvbuf()</code> <em>before</em> any I/O operation is performed on
the stream, or else by then it might be too late.</p>
<p>The next argument, <code>buf</code> allows you to make your own
buffer space (using <a href="stdlib.html#man-malloc"><code>malloc()</code></a> or
just a <code>char</code> array) to use for buffering. If you don’t care
to do this, just set <code>buf</code> to <code>NULL</code>.</p>
<p>Now we get to the real meat of the function: <code>mode</code> allows
you to choose what kind of buffering you want to use on this
<code>stream</code>. Set it to one of the following:</p>
<table>
<thead>
<tr class="header">
<th>Mode</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>_IOFBF</code></td>
<td><code>stream</code> will be fully buffered.</td>
</tr>
<tr class="even">
<td><code>_IOLBF</code></td>
<td><code>stream</code> will be line buffered.</td>
</tr>
<tr class="odd">
<td><code>_IONBF</code></td>
<td><code>stream</code> will be unbuffered.</td>
</tr>
</tbody>
</table>
<p>Finally, the <code>size</code> argument is the size of the array you
passed in for <code>buf</code>…unless you passed <code>NULL</code> for
<code>buf</code>, in which case it will resize the existing buffer to
the size you specify.</p>
<p>Now what about this lesser function <code>setbuf()</code>? It’s just
like calling <code>setvbuf()</code> with some specific parameters,
except <code>setbuf()</code> doesn’t return a value. The following
example shows the equivalency:</p>
<div class="sourceCode" id="cb1240"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1240-1"><a href="stdio.html#cb1240-1" aria-hidden="true" tabindex="-1"></a><span class="co">// these are the same:</span></span>
<span id="cb1240-2"><a href="stdio.html#cb1240-2" aria-hidden="true" tabindex="-1"></a>setbuf<span class="op">(</span>stream<span class="op">,</span> buf<span class="op">);</span></span>
<span id="cb1240-3"><a href="stdio.html#cb1240-3" aria-hidden="true" tabindex="-1"></a>setvbuf<span class="op">(</span>stream<span class="op">,</span> buf<span class="op">,</span> _IOFBF<span class="op">,</span> BUFSIZ<span class="op">);</span> <span class="co">// fully buffered</span></span>
<span id="cb1240-4"><a href="stdio.html#cb1240-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1240-5"><a href="stdio.html#cb1240-5" aria-hidden="true" tabindex="-1"></a><span class="co">// and these are the same:</span></span>
<span id="cb1240-6"><a href="stdio.html#cb1240-6" aria-hidden="true" tabindex="-1"></a>setbuf<span class="op">(</span>stream<span class="op">,</span> NULL<span class="op">);</span></span>
<span id="cb1240-7"><a href="stdio.html#cb1240-7" aria-hidden="true" tabindex="-1"></a>setvbuf<span class="op">(</span>stream<span class="op">,</span> NULL<span class="op">,</span> _IONBF<span class="op">,</span> BUFSIZ<span class="op">);</span> <span class="co">// unbuffered</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="return-value-141">Return Value</h3>
<p><code>setvbuf()</code> returns zero on success, and nonzero on
failure. <code>setbuf()</code> has no return value.</p>
<h3 class="unnumbered unlisted" id="example-144">Example</h3>
<div class="sourceCode" id="cb1241"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1241-1"><a href="stdio.html#cb1241-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1241-2"><a href="stdio.html#cb1241-2"></a></span>
<span id="cb1241-3"><a href="stdio.html#cb1241-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1241-4"><a href="stdio.html#cb1241-4"></a><span class="op">{</span></span>
<span id="cb1241-5"><a href="stdio.html#cb1241-5"></a>    <span class="dt">FILE</span> <span class="op">*</span>fp<span class="op">;</span></span>
<span id="cb1241-6"><a href="stdio.html#cb1241-6"></a>    <span class="dt">char</span> lineBuf<span class="op">[</span><span class="dv">1024</span><span class="op">];</span></span>
<span id="cb1241-7"><a href="stdio.html#cb1241-7"></a></span>
<span id="cb1241-8"><a href="stdio.html#cb1241-8"></a>    fp <span class="op">=</span> fopen<span class="op">(</span><span class="st">"somefile.txt"</span><span class="op">,</span> <span class="st">"w"</span><span class="op">);</span></span>
<span id="cb1241-9"><a href="stdio.html#cb1241-9"></a>    setvbuf<span class="op">(</span>fp<span class="op">,</span> lineBuf<span class="op">,</span> _IOLBF<span class="op">,</span> <span class="dv">1024</span><span class="op">);</span>  <span class="co">// set to line buffering</span></span>
<span id="cb1241-10"><a href="stdio.html#cb1241-10"></a>    fprintf<span class="op">(</span>fp<span class="op">,</span> <span class="st">"You won't see this in the file yet. "</span><span class="op">);</span></span>
<span id="cb1241-11"><a href="stdio.html#cb1241-11"></a>    fprintf<span class="op">(</span>fp<span class="op">,</span> <span class="st">"But now you will because of this newline.</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1241-12"><a href="stdio.html#cb1241-12"></a>    fclose<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb1241-13"><a href="stdio.html#cb1241-13"></a></span>
<span id="cb1241-14"><a href="stdio.html#cb1241-14"></a>    fp <span class="op">=</span> fopen<span class="op">(</span><span class="st">"anotherfile.txt"</span><span class="op">,</span> <span class="st">"w"</span><span class="op">);</span></span>
<span id="cb1241-15"><a href="stdio.html#cb1241-15"></a>    setbuf<span class="op">(</span>fp<span class="op">,</span> NULL<span class="op">);</span> <span class="co">// set to unbuffered</span></span>
<span id="cb1241-16"><a href="stdio.html#cb1241-16"></a>    fprintf<span class="op">(</span>fp<span class="op">,</span> <span class="st">"You will see this in the file now."</span><span class="op">);</span></span>
<span id="cb1241-17"><a href="stdio.html#cb1241-17"></a>    fclose<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb1241-18"><a href="stdio.html#cb1241-18"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-135">See Also</h3>
<p><a href="stdio.html#man-fflush"><code>fflush()</code></a></p>
<hr>
<h2 data-number="61.10" id="man-printf"><span class="header-section-number">61.10</span> <code>printf()</code>,
<code>fprintf()</code>, <code>sprintf()</code>,
<code>snprintf()</code></h2>
<p>Print a formatted string to the console or to a file</p>
<h3 class="unnumbered unlisted" id="synopsis-144">Synopsis</h3>
<div class="sourceCode" id="cb1242"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1242-1"><a href="stdio.html#cb1242-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1242-2"><a href="stdio.html#cb1242-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1242-3"><a href="stdio.html#cb1242-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> printf<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>format<span class="op">,</span> <span class="op">...);</span></span>
<span id="cb1242-4"><a href="stdio.html#cb1242-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1242-5"><a href="stdio.html#cb1242-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fprintf<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>format<span class="op">,</span> <span class="op">...);</span></span>
<span id="cb1242-6"><a href="stdio.html#cb1242-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1242-7"><a href="stdio.html#cb1242-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sprintf<span class="op">(</span><span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> s<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> format<span class="op">,</span> <span class="op">...);</span></span>
<span id="cb1242-8"><a href="stdio.html#cb1242-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1242-9"><a href="stdio.html#cb1242-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> snprintf<span class="op">(</span><span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> s<span class="op">,</span> <span class="dt">size_t</span> n<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> format<span class="op">,</span> <span class="op">...);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-144">Description</h3>
<p>These functions print formatted output to a variety of
destinations.</p>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>Output Destination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>printf()</code></td>
<td>Print to console (screen by default, typically).</td>
</tr>
<tr class="even">
<td><code>fprintf()</code></td>
<td>Print to a file.</td>
</tr>
<tr class="odd">
<td><code>sprintf()</code></td>
<td>Print to a string.</td>
</tr>
<tr class="even">
<td><code>snprintf()</code></td>
<td>Print to a string (safely).</td>
</tr>
</tbody>
</table>
<p>The only differences between these is are the leading parameters that
you pass to them before the <code>format</code> string.</p>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>What you pass before <code>format</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>printf()</code></td>
<td>Nothing comes before <code>format</code>.</td>
</tr>
<tr class="even">
<td><code>fprintf()</code></td>
<td>Pass a <code>FILE*</code>.</td>
</tr>
<tr class="odd">
<td><code>sprintf()</code></td>
<td>Pass a <code>char*</code> to a buffer to print into.</td>
</tr>
<tr class="even">
<td><code>snprintf()</code></td>
<td>Pass a <code>char*</code> to the buffer and a maximum buffer
length.</td>
</tr>
</tbody>
</table>
<p>The <code>printf()</code> function is legendary as being one of the
most flexible outputting systems ever devised. It can also get a bit
freaky here or there, most notably in the <code>format</code> string.
We’ll take it a step at a time here.</p>
<p>The easiest way to look at the format string is that it will print
everything in the string as-is, <em>unless</em> a character has a
percent sign (<code>%</code>) in front of it. That’s when the magic
happens: the next argument in the <code>printf()</code> argument list is
printed in the way described by the percent code. These percent codes
are called <em>format specifiers</em>.</p>
<p>Here are the most common format specifiers.</p>
<table>
<colgroup>
<col style="width: 13%">
<col style="width: 86%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Specifier</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>%d</code></td>
<td>Print the next argument as a signed decimal number, like
<code>3490</code>. The argument printed this way should be an
<code>int</code>, or something that gets promoted to
<code>int</code>.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>%f</code></td>
<td>Print the next argument as a signed floating point number, like
<code>3.14159</code>. The argument printed this way should be a
<code>double</code>, or something that gets promoted to a
<code>double</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>%c</code></td>
<td>Print the next argument as a character, like <code>'B'</code>. The
argument printed this way should be a <code>char</code> variant.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>%s</code></td>
<td>Print the next argument as a string, like
<code>"Did you remember your mittens?"</code>. The argument printed this
way should be a <code>char*</code> or <code>char[]</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>%%</code></td>
<td>No arguments are converted, and a plain old run-of-the-mill percent
sign is printed. This is how you print a ‘%’ using
<code>printf()</code>.</td>
</tr>
</tbody>
</table>
<p>So those are the basics. I’ll give you some more of the format
specifiers in a bit, but let’s get some more breadth before then.
There’s actually a lot more that you can specify in there after the
percent sign.</p>
<p>For one thing, you can put a field width in there—this is a number
that tells <code>printf()</code> how many spaces to put on one side or
the other of the value you’re printing. That helps you line things up in
nice columns. If the number is negative, the result becomes
left-justified instead of right-justified. Example:</p>
<div class="sourceCode" id="cb1243"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1243-1"><a href="stdio.html#cb1243-1" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"%10d"</span><span class="op">,</span> x<span class="op">);</span>  <span class="co">/* prints X on the right side of the 10-space field */</span></span>
<span id="cb1243-2"><a href="stdio.html#cb1243-2" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"%-10d"</span><span class="op">,</span> x<span class="op">);</span> <span class="co">/* prints X on the left side of the 10-space field */</span></span></code></pre></div>
<p>If you don’t know the field width in advance, you can use a little
kung-foo to get it from the argument list just before the argument
itself. Do this by placing your seat and tray tables in the fully
upright position. The seatbelt is fastened by placing
the—<em><em>cough</em></em>. I seem to have been doing way too much
flying lately. Ignoring that useless fact completely, you can specify a
dynamic field width by putting a <code>*</code> in for the width. If you
are not willing or able to perform this task, please notify a flight
attendant and we will reseat you.</p>
<div class="sourceCode" id="cb1244"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1244-1"><a href="stdio.html#cb1244-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> width <span class="op">=</span> <span class="dv">12</span><span class="op">;</span></span>
<span id="cb1244-2"><a href="stdio.html#cb1244-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> value <span class="op">=</span> <span class="dv">3490</span><span class="op">;</span></span>
<span id="cb1244-3"><a href="stdio.html#cb1244-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1244-4"><a href="stdio.html#cb1244-4" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"%*d</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> width<span class="op">,</span> value<span class="op">);</span></span></code></pre></div>
<p>You can also put a “0” in front of the number if you want it to be
padded with zeros:</p>
<div class="sourceCode" id="cb1245"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1245-1"><a href="stdio.html#cb1245-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> x <span class="op">=</span> <span class="dv">17</span><span class="op">;</span></span>
<span id="cb1245-2"><a href="stdio.html#cb1245-2" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"%05d"</span><span class="op">,</span> x<span class="op">);</span>  <span class="co">/* "00017" */</span></span></code></pre></div>
<p>When it comes to floating point, you can also specify how many
decimal places to print by making a field width of the form
“<code>x.y</code>” where <code>x</code> is the field width (you can
leave this off if you want it to be just wide enough) and <code>y</code>
is the number of digits past the decimal point to print:</p>
<div class="sourceCode" id="cb1246"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1246-1"><a href="stdio.html#cb1246-1" aria-hidden="true" tabindex="-1"></a><span class="dt">float</span> f <span class="op">=</span> <span class="fl">3.1415926535</span><span class="op">;</span></span>
<span id="cb1246-2"><a href="stdio.html#cb1246-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1246-3"><a href="stdio.html#cb1246-3" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"%.2f"</span><span class="op">,</span> f<span class="op">);</span>  <span class="co">/* "3.14" */</span></span>
<span id="cb1246-4"><a href="stdio.html#cb1246-4" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"%7.3f"</span><span class="op">,</span> f<span class="op">);</span> <span class="co">/* "  3.141" &lt;-- 7 spaces across */</span></span></code></pre></div>
<p>Ok, those above are definitely the most common uses of
<code>printf()</code>, but let’s get <em>total coverage</em>.</p>
<h4 data-number="61.10.0.1" id="format-specifier-layout"><span class="header-section-number">61.10.0.1</span> Format Specifier
Layout</h4>
<p>Technically, the layout of the format specifier is these things in
this order:</p>
<ol type="1">
<li><code>%</code>, followed by…</li>
<li>Optional: zero or more flags, left justify, leading zeros, etc.</li>
<li>Optional: Field width, how wide the output field should be.</li>
<li>Optional: Precision, or how many decimal places to print.</li>
<li>Optional: Length modifier, for printing things bigger than
<code>int</code> or <code>double</code>.</li>
<li>Conversion specifier, like <code>d</code>, <code>f</code>, etc.</li>
</ol>
<p>In short, the whole format specifier is laid out like this:</p>
<pre><code>%[flags][fieldwidth][.precision][lengthmodifier]conversionspecifier</code></pre>
<p>What could be easier?</p>
<h4 data-number="61.10.0.2" id="conversion-specifiers"><span class="header-section-number">61.10.0.2</span> Conversion
Specifiers</h4>
<p>Let’s talk conversion specifiers first. Each of the following
specifies what type it can print, but it can also print anything that
gets promoted to that type. For example, <code>%d</code> can print
<code>int</code>, <code>short</code>, and <code>char</code>.</p>
<table>
<colgroup>
<col style="width: 13%">
<col style="width: 86%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Conversion Specifier</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>d</code></td>
<td>Print an <code>int</code> argument as a decimal number.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>i</code></td>
<td>Identical to <code>d</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>o</code></td>
<td>Print an <code>unsigned int</code> in octal (base 8).</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>u</code></td>
<td>Print an <code>unsigned int</code> in decimal.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>x</code></td>
<td>Print an <code>unsigned int</code> in hexadecimal with lowercase
letters.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>X</code></td>
<td>Print an <code>unsigned int</code> in hexadecimal with uppercase
letters.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>f</code></td>
<td>Print a <code>double</code> in decimal notation. Infinity is printed
as <code>infinity</code> or <code>inf</code>, and NaN is printed as
<code>nan</code>, any of which could have a leading minus sign.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>F</code></td>
<td>Same as <code>f</code>, except it prints out <code>INFINITY</code>,
<code>INF</code>, or <code>NAN</code> in all caps.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>e</code></td>
<td>Print a number in scientific notation, e.g.&nbsp;<code>1.234e56</code>.
Does infinity and NaN like <code>f</code>.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>E</code></td>
<td>Just like <code>e</code>, except prints the exponent <code>E</code>
(and infinity and NaN) in uppercase.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>g</code></td>
<td>Print small numbers like <code>f</code> and large numbers like
<code>e</code>. See note below.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>G</code></td>
<td>Print small numbers like <code>F</code> and large numbers like
<code>E</code>. See note below.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>a</code></td>
<td>Print a <code>double</code> in hexadecimal form
<code>0xh.hhhhpd</code> where <code>h</code> is a lowercase hex digit
and <code>d</code> is a decimal exponent of 2. Infinity and NaN in the
form of <code>f</code>. More below.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>A</code></td>
<td>Like <code>a</code> except everything’s uppercase.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>c</code></td>
<td>Convert <code>int</code> argument to <code>unsigned char</code> and
print as a character.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>s</code></td>
<td>Print a string starting at the given <code>char*</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>p</code></td>
<td>Print a <code>void*</code> out as a number, probably the numeric
address, possibly in hex.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>n</code></td>
<td>Store the number of characters written so far in the given
<code>int*</code>. Doesn’t print anything. See below.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>%</code></td>
<td>Print a literal percent sign.</td>
</tr>
</tbody>
</table>
<h5 data-number="61.10.0.2.1" id="note-on-a-and-a"><span class="header-section-number">61.10.0.2.1</span> Note on <code>%a</code>
and <code>%A</code></h5>
<p>When printing floating point numbers in hex form, there is one number
before the decimal point, and the rest of are out to the precision.</p>
<div class="sourceCode" id="cb1248"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1248-1"><a href="stdio.html#cb1248-1" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> pi <span class="op">=</span> <span class="fl">3.14159265358979</span><span class="op">;</span></span>
<span id="cb1248-2"><a href="stdio.html#cb1248-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1248-3"><a href="stdio.html#cb1248-3" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"%.3a</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> pi<span class="op">);</span>  <span class="co">// 0x1.922p+1</span></span></code></pre></div>
<p>C can choose the leading number in such a way to ensure subsequent
digits align to 4-bit boundaries.</p>
<p>If the precision is left out and the macro <code>FLT_RADIX</code> is
a power of 2, enough precision is used to represent the number exactly.
If <code>FLT_RADIX</code> is not a power of two, enough precision is
used to be able to tell any two floating values apart.</p>
<p>If the precision is <code>0</code> and the <code>#</code> flag isn’t
specified, the decimal point is omitted.</p>
<h5 data-number="61.10.0.2.2" id="note-on-g-and-g"><span class="header-section-number">61.10.0.2.2</span> Note on <code>%g</code>
and <code>%G</code></h5>
<p>The gist of this is to use scientific notation when the number gets
too “extreme”, and regular decimal notation otherwise.</p>
<p>The exact behavior for whether these print as <code>%f</code> or
<code>%e</code> depends on a number of factors:</p>
<p>If the number’s exponent is greater than or equal to -4
<strong>and</strong> the precision is greater than the exponent, we use
<code>%f</code>. In this case, the precision is converted according to
<span class="math inline"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="0" style="font-size: 103.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>=</mo><mi>p</mi><mo>−</mo><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span>, where <span class="math inline"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="1" style="font-size: 103.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></mjx-assistive-mml></mjx-container></span> is the specified precision and <span class="math inline"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="2" style="font-size: 103.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span> is the exponent.</p>
<p>Otherwise we use <code>%e</code>, and the precision becomes <span class="math inline"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="3" style="font-size: 103.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>−</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span>.</p>
<p>Trailing zeros in the decimal portion are removed. And if there are
none left, the decimal point is removed, too. All this unless the
<code>#</code> flag is specified.</p>
<h5 data-number="61.10.0.2.3" id="note-on-n"><span class="header-section-number">61.10.0.2.3</span> Note on
<code>%n</code></h5>
<p>This specifier is cool and different, and rarely needed. It doesn’t
actually print anything, but stores the number of characters printed so
far in the next pointer argument in the list.</p>
<div class="sourceCode" id="cb1249"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1249-1"><a href="stdio.html#cb1249-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> numChars<span class="op">;</span></span>
<span id="cb1249-2"><a href="stdio.html#cb1249-2" aria-hidden="true" tabindex="-1"></a><span class="dt">float</span> a <span class="op">=</span> <span class="fl">3.14159</span><span class="op">;</span></span>
<span id="cb1249-3"><a href="stdio.html#cb1249-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> b <span class="op">=</span> <span class="dv">3490</span><span class="op">;</span></span>
<span id="cb1249-4"><a href="stdio.html#cb1249-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1249-5"><a href="stdio.html#cb1249-5" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"%f %d%n</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> <span class="op">&amp;</span>numChars<span class="op">);</span></span>
<span id="cb1249-6"><a href="stdio.html#cb1249-6" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"The above line contains %d characters.</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> numChars<span class="op">);</span></span></code></pre></div>
<p>The above example will print out the values of <code>a</code> and
<code>b</code>, and then store the number of characters printed so far
into the variable <code>numChars</code>. The next call to
<code>printf()</code> prints out that result.</p>
<div class="sourceCode" id="cb1250"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb1250-1"><a href="stdio.html#cb1250-1" aria-hidden="true" tabindex="-1"></a>3.141590 3490</span>
<span id="cb1250-2"><a href="stdio.html#cb1250-2" aria-hidden="true" tabindex="-1"></a>The above line contains 13 characters</span></code></pre></div>
<h4 data-number="61.10.0.3" id="length-modifiers"><span class="header-section-number">61.10.0.3</span> Length Modifiers</h4>
<p>You can stick a <em>length</em> modifier in front of each of the
conversion specifiers, if you want. most of those format specifiers work
on <code>int</code> or <code>double</code> types, but what if you want
larger or smaller types? That’s what these are good for.</p>
<p>For example, you could print out a long long int with the
<code>ll</code> modifier:</p>
<div class="sourceCode" id="cb1251"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1251-1"><a href="stdio.html#cb1251-1" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> <span class="dt">int</span> x <span class="op">=</span> <span class="dv">3490</span><span class="op">;</span></span>
<span id="cb1251-2"><a href="stdio.html#cb1251-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1251-3"><a href="stdio.html#cb1251-3" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"%lld</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> x<span class="op">);</span>  <span class="co">// 3490</span></span></code></pre></div>
<table>
<colgroup>
<col style="width: 13%">
<col style="width: 24%">
<col style="width: 62%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Length Modifier</th>
<th style="text-align: center;">Conversion Specifier</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>hh</code></td>
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>Convert argument to <code>char</code> (signed or unsigned as
appropriate) before printing.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>h</code></td>
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>Convert argument to <code>short int</code> (signed or unsigned as
appropriate) before printing.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>l</code></td>
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>Argument is a <code>long int</code> (signed or unsigned as
appropriate).</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>ll</code></td>
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>Argument is a <code>long long int</code> (signed or unsigned as
appropriate).</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>j</code></td>
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>Argument is a <code>intmax_t</code> or <code>uintmax_t</code> (as
appropriate).</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>z</code></td>
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>Argument is a <code>size_t</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>t</code></td>
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>Argument is a <code>ptrdiff_t</code>.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>L</code></td>
<td style="text-align: center;"><code>a</code>, <code>A</code>,
<code>e</code>, <code>E</code>, <code>f</code>, <code>F</code>,
<code>g</code>, <code>G</code></td>
<td>Argument is a <code>long double</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>l</code></td>
<td style="text-align: center;"><code>c</code></td>
<td>Argument is in a <code>wint_t</code>, a wide character.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>l</code></td>
<td style="text-align: center;"><code>s</code></td>
<td>Argument is in a <code>wchar_t*</code>, a wide character
string.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>hh</code></td>
<td style="text-align: center;"><code>n</code></td>
<td>Store result in <code>signed char*</code> argument.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>h</code></td>
<td style="text-align: center;"><code>n</code></td>
<td>Store result in <code>short int*</code> argument.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>l</code></td>
<td style="text-align: center;"><code>n</code></td>
<td>Store result in <code>long int*</code> argument.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>ll</code></td>
<td style="text-align: center;"><code>n</code></td>
<td>Store result in <code>long long int*</code> argument.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>j</code></td>
<td style="text-align: center;"><code>n</code></td>
<td>Store result in <code>intmax_t*</code> argument.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>z</code></td>
<td style="text-align: center;"><code>n</code></td>
<td>Store result in <code>size_t*</code> argument.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>t</code></td>
<td style="text-align: center;"><code>n</code></td>
<td>Store result in <code>ptrdiff_t*</code> argument.</td>
</tr>
</tbody>
</table>
<h4 data-number="61.10.0.4" id="precision"><span class="header-section-number">61.10.0.4</span> Precision</h4>
<p>In front of the length modifier, you can put a precision, which
generally means how many decimal places you want on your floating point
numbers.</p>
<p>To do this, you put a decimal point (<code>.</code>) and the decimal
places afterward.</p>
<p>For example, we could print π rounded to two decimal places like
this:</p>
<div class="sourceCode" id="cb1252"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1252-1"><a href="stdio.html#cb1252-1" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> pi <span class="op">=</span> <span class="fl">3.14159265358979</span><span class="op">;</span></span>
<span id="cb1252-2"><a href="stdio.html#cb1252-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1252-3"><a href="stdio.html#cb1252-3" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"%.2f</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> pi<span class="op">);</span>  <span class="co">// 3.14</span></span></code></pre></div>
<table>
<colgroup>
<col style="width: 30%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Conversion Specifier</th>
<th>Precision Value Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>For integer types, minimum number of digits (will pad with leading
zeros)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>a</code>, <code>e</code>,
<code>f</code>, <code>A</code>, <code>E</code>, <code>F</code></td>
<td>For floating types, the precision is the number of digits past the
decimal.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>g</code>, <code>G</code></td>
<td>For floating types, the precision is the number of significant
digits printed.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>s</code></td>
<td>The maximum number of bytes (not multibyte characters!) to be
written.</td>
</tr>
</tbody>
</table>
<p>If no number is specified in the precision after the decimal point,
the precision is zero.</p>
<p>If an <code>*</code> is specified after the decimal, something
amazing happens! It means the <code>int</code> argument to
<code>printf()</code> before the number to be printed holds the
precision. You can use this if you don’t know the precision at compile
time.</p>
<div class="sourceCode" id="cb1253"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1253-1"><a href="stdio.html#cb1253-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> precision<span class="op">;</span></span>
<span id="cb1253-2"><a href="stdio.html#cb1253-2" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> pi <span class="op">=</span> <span class="fl">3.14159265358979</span><span class="op">;</span></span>
<span id="cb1253-3"><a href="stdio.html#cb1253-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1253-4"><a href="stdio.html#cb1253-4" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"Enter precision: "</span><span class="op">);</span> fflush<span class="op">(</span>stdout<span class="op">);</span></span>
<span id="cb1253-5"><a href="stdio.html#cb1253-5" aria-hidden="true" tabindex="-1"></a>scanf<span class="op">(</span><span class="st">"%d"</span><span class="op">,</span> <span class="op">&amp;</span>precision<span class="op">);</span></span>
<span id="cb1253-6"><a href="stdio.html#cb1253-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1253-7"><a href="stdio.html#cb1253-7" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"%.*f</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> precision<span class="op">,</span> pi<span class="op">);</span></span></code></pre></div>
<p>Which gives:</p>
<div class="sourceCode" id="cb1254"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb1254-1"><a href="stdio.html#cb1254-1" aria-hidden="true" tabindex="-1"></a>Enter precision: 4</span>
<span id="cb1254-2"><a href="stdio.html#cb1254-2" aria-hidden="true" tabindex="-1"></a>3.1416</span></code></pre></div>
<h4 data-number="61.10.0.5" id="field-width"><span class="header-section-number">61.10.0.5</span> Field Width</h4>
<p>In front of the optional precision, you can indicate a field width.
This is a decimal number that indicates how wide the region should be in
which the argument is printed. The region is padding with leading (or
trailing) spaces to make sure it’s wide enough.</p>
<p>If the field width specified is too small to hold the output, it is
ignored.</p>
<p>As a preview, you can give a negative field width to justify the item
the other direction.</p>
<p>So let’s print a number in a field of width 10. We’ll put some angle
brackets around it so we can see the padding spaces in the output.</p>
<div class="sourceCode" id="cb1255"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1255-1"><a href="stdio.html#cb1255-1" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"&lt;&lt;%10d&gt;&gt;</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> <span class="dv">3490</span><span class="op">);</span>   <span class="co">// right justified</span></span>
<span id="cb1255-2"><a href="stdio.html#cb1255-2" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"&lt;&lt;%-10d&gt;&gt;</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> <span class="dv">3490</span><span class="op">);</span>  <span class="co">// left justified</span></span></code></pre></div>
<div class="sourceCode" id="cb1256"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb1256-1"><a href="stdio.html#cb1256-1" aria-hidden="true" tabindex="-1"></a>&lt;&lt;      3490&gt;&gt;</span>
<span id="cb1256-2"><a href="stdio.html#cb1256-2" aria-hidden="true" tabindex="-1"></a>&lt;&lt;3490      &gt;&gt;</span></code></pre></div>
<p>Like with the precision, you can use an asterisk (<code>*</code>) as
the field width</p>
<div class="sourceCode" id="cb1257"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1257-1"><a href="stdio.html#cb1257-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> field_width<span class="op">;</span></span>
<span id="cb1257-2"><a href="stdio.html#cb1257-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> val <span class="op">=</span> <span class="dv">3490</span><span class="op">;</span></span>
<span id="cb1257-3"><a href="stdio.html#cb1257-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1257-4"><a href="stdio.html#cb1257-4" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"Enter field_width: "</span><span class="op">);</span> fflush<span class="op">(</span>stdout<span class="op">);</span></span>
<span id="cb1257-5"><a href="stdio.html#cb1257-5" aria-hidden="true" tabindex="-1"></a>scanf<span class="op">(</span><span class="st">"%d"</span><span class="op">,</span> <span class="op">&amp;</span>field_width<span class="op">);</span></span>
<span id="cb1257-6"><a href="stdio.html#cb1257-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1257-7"><a href="stdio.html#cb1257-7" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"&lt;&lt;%*d&gt;&gt;</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> field_width<span class="op">,</span> val<span class="op">);</span></span></code></pre></div>
<h4 data-number="61.10.0.6" id="flags"><span class="header-section-number">61.10.0.6</span> Flags</h4>
<p>Before the field width, you can put some optional flags that further
control the output of the subsequent fields. We just saw that the
<code>-</code> flag can be used to left- or right-justify fields. But
there are plenty more!</p>
<table>
<colgroup>
<col style="width: 13%">
<col style="width: 86%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>-</code></td>
<td>For a field width, left justify in the field (right is
default).</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>+</code></td>
<td>If the number is signed, always prefix a <code>+</code> or
<code>-</code> on the front.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">[SPACE]</td>
<td>If the number is signed, prefix a space for positive, or a
<code>-</code> for negative.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>0</code></td>
<td>Pad the right-justified field with leading zeros instead of leading
spaces.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>#</code></td>
<td>Print using an alternate form. See below.</td>
</tr>
</tbody>
</table>
<p>For example, we could pad a hexadecimal number with leading zeros to
a field width of 8 with:</p>
<div class="sourceCode" id="cb1258"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1258-1"><a href="stdio.html#cb1258-1" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"%08x</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> <span class="bn">0x1234</span><span class="op">);</span>  <span class="co">// 00001234</span></span></code></pre></div>
<p>The <code>#</code> “alternate form” result depends on the conversion
specifier.</p>
<table>
<colgroup>
<col style="width: 22%">
<col style="width: 78%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Conversion Specifier</th>
<th>Alternate Form (<code>#</code>) Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>o</code></td>
<td>Increase precision of a non-zero number just enough to get one
leading <code>0</code> on the octal number.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>x</code></td>
<td>Prefix a non-zero number with <code>0x</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>X</code></td>
<td>Same as <code>x</code>, except capital <code>0X</code>.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>a</code>, <code>e</code>,
<code>f</code></td>
<td>Always print a decimal point, even if nothing follows it.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>A</code>, <code>E</code>,
<code>F</code></td>
<td>Identical to <code>a</code>, <code>e</code>, <code>f</code>.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>g</code>, <code>G</code></td>
<td>Always print a decimal point, even if nothing follows it, and keep
trailing zeros.</td>
</tr>
</tbody>
</table>
<h4 data-number="61.10.0.7" id="sprintf-and-snprintf-details"><span class="header-section-number">61.10.0.7</span> <code>sprintf()</code>
and <code>snprintf()</code> Details</h4>
<p>Both <code>sprintf()</code> and <code>snprintf()</code> have the
quality that if you pass in <code>NULL</code> as the buffer, nothing is
written—but you can still check the return value to see how many
characters <em>would</em> have been written.</p>
<p><code>snprintf()</code> <strong>always</strong> terminates the string
with a <code>NUL</code> character. So if you try to write out more than
the maximum specified characters, the universe ends.</p>
<p>Just kidding. If you do, <code>snprintf()</code> will write <span class="math inline"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="4" style="font-size: 103.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>−</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span> characters so that it has enough room
to write the terminator at the end.</p>
<h3 class="unnumbered unlisted" id="return-value-142">Return Value</h3>
<p>Returns the number of characters outputted, or a negative number on
error.</p>
<h3 class="unnumbered unlisted" id="example-145">Example</h3>
<div class="sourceCode" id="cb1259"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1259-1"><a href="stdio.html#cb1259-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1259-2"><a href="stdio.html#cb1259-2"></a></span>
<span id="cb1259-3"><a href="stdio.html#cb1259-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1259-4"><a href="stdio.html#cb1259-4"></a><span class="op">{</span></span>
<span id="cb1259-5"><a href="stdio.html#cb1259-5"></a>    <span class="dt">int</span> a <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb1259-6"><a href="stdio.html#cb1259-6"></a>    <span class="dt">float</span> b <span class="op">=</span> <span class="fl">2.717</span><span class="op">;</span></span>
<span id="cb1259-7"><a href="stdio.html#cb1259-7"></a>    <span class="dt">char</span> <span class="op">*</span>c <span class="op">=</span> <span class="st">"beej!"</span><span class="op">;</span></span>
<span id="cb1259-8"><a href="stdio.html#cb1259-8"></a>    <span class="dt">char</span> d <span class="op">=</span> <span class="ch">'X'</span><span class="op">;</span></span>
<span id="cb1259-9"><a href="stdio.html#cb1259-9"></a>    <span class="dt">int</span> e <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb1259-10"><a href="stdio.html#cb1259-10"></a></span>
<span id="cb1259-11"><a href="stdio.html#cb1259-11"></a>    printf<span class="op">(</span><span class="st">"%d</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> a<span class="op">);</span> <span class="co">/* "100"      */</span></span>
<span id="cb1259-12"><a href="stdio.html#cb1259-12"></a>    printf<span class="op">(</span><span class="st">"%f</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> b<span class="op">);</span> <span class="co">/* "2.717000" */</span></span>
<span id="cb1259-13"><a href="stdio.html#cb1259-13"></a>    printf<span class="op">(</span><span class="st">"%s</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> c<span class="op">);</span> <span class="co">/* "beej!"    */</span></span>
<span id="cb1259-14"><a href="stdio.html#cb1259-14"></a>    printf<span class="op">(</span><span class="st">"%c</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> d<span class="op">);</span> <span class="co">/* "X"        */</span></span>
<span id="cb1259-15"><a href="stdio.html#cb1259-15"></a>    printf<span class="op">(</span><span class="st">"110%%</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span> <span class="co">/* "110%"     */</span></span>
<span id="cb1259-16"><a href="stdio.html#cb1259-16"></a></span>
<span id="cb1259-17"><a href="stdio.html#cb1259-17"></a>    printf<span class="op">(</span><span class="st">"%10d</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> a<span class="op">);</span>   <span class="co">/* "       100" */</span></span>
<span id="cb1259-18"><a href="stdio.html#cb1259-18"></a>    printf<span class="op">(</span><span class="st">"%-10d</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> a<span class="op">);</span>  <span class="co">/* "100       " */</span></span>
<span id="cb1259-19"><a href="stdio.html#cb1259-19"></a>    printf<span class="op">(</span><span class="st">"%*d</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> e<span class="op">,</span> a<span class="op">);</span> <span class="co">/* "  100"      */</span></span>
<span id="cb1259-20"><a href="stdio.html#cb1259-20"></a>    printf<span class="op">(</span><span class="st">"%.2f</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> b<span class="op">);</span>   <span class="co">/* "2.72"       */</span></span>
<span id="cb1259-21"><a href="stdio.html#cb1259-21"></a></span>
<span id="cb1259-22"><a href="stdio.html#cb1259-22"></a>    printf<span class="op">(</span><span class="st">"%hhd</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> d<span class="op">);</span> <span class="co">/* "88" &lt;-- ASCII code for 'X' */</span></span>
<span id="cb1259-23"><a href="stdio.html#cb1259-23"></a></span>
<span id="cb1259-24"><a href="stdio.html#cb1259-24"></a>    printf<span class="op">(</span><span class="st">"%5d %5.2f %c</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> d<span class="op">);</span> <span class="co">/* "  100  2.72 X" */</span></span>
<span id="cb1259-25"><a href="stdio.html#cb1259-25"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-136">See Also</h3>
<p><a href="stdio.html#man-printf"><code>sprintf()</code></a>, <a href="#man-vprintf"><code>vprintf()</code></a></p>
<hr>
<h2 data-number="61.11" id="man-scanf"><span class="header-section-number">61.11</span> <code>scanf()</code>,
<code>fscanf()</code>, <code>sscanf()</code></h2>
<p>Read formatted string, character, or numeric data from the console or
from a file</p>
<h3 class="unnumbered unlisted" id="synopsis-145">Synopsis</h3>
<div class="sourceCode" id="cb1260"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1260-1"><a href="stdio.html#cb1260-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1260-2"><a href="stdio.html#cb1260-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1260-3"><a href="stdio.html#cb1260-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> scanf<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>format<span class="op">,</span> <span class="op">...);</span></span>
<span id="cb1260-4"><a href="stdio.html#cb1260-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1260-5"><a href="stdio.html#cb1260-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fscanf<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>format<span class="op">,</span> <span class="op">...);</span></span>
<span id="cb1260-6"><a href="stdio.html#cb1260-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1260-7"><a href="stdio.html#cb1260-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sscanf<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> s<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> format<span class="op">,</span> <span class="op">...);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-145">Description</h3>
<p>These functions read formatted output from a variety of sources.</p>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>Input Source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>scanf()</code></td>
<td>Read from the console (keyboard by default, typically).</td>
</tr>
<tr class="even">
<td><code>fscanf()</code></td>
<td>Read from a file.</td>
</tr>
<tr class="odd">
<td><code>sscanf()</code></td>
<td>Read from a string.</td>
</tr>
</tbody>
</table>
<p>The only differences between these is are the leading parameters that
you pass to them before the <code>format</code> string.</p>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>What you pass before <code>format</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>scanf()</code></td>
<td>Nothing comes before <code>format</code>.</td>
</tr>
<tr class="even">
<td><code>fscanf()</code></td>
<td>Pass a <code>FILE*</code>.</td>
</tr>
<tr class="odd">
<td><code>sscanf()</code></td>
<td>Pass a <code>char*</code> to a buffer to read from.</td>
</tr>
</tbody>
</table>
<p>The <code>scanf()</code> family of functions reads data from the
console or from a <code>FILE</code> stream, parses it, and stores the
results away in variables you provide in the argument list.</p>
<p>The format string is very similar to that in <code>printf()</code> in
that you can tell it to read a <code>"%d"</code>, for instance for an
<code>int</code>. But it also has additional capabilities, most notably
that it can eat up other characters in the input that you specify in the
format string.</p>
<p>But let’s start simple, and look at the most basic usage first before
plunging into the depths of the function. We’ll start by reading an
<code>int</code> from the keyboard:</p>
<div class="sourceCode" id="cb1261"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1261-1"><a href="stdio.html#cb1261-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> a<span class="op">;</span></span>
<span id="cb1261-2"><a href="stdio.html#cb1261-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1261-3"><a href="stdio.html#cb1261-3" aria-hidden="true" tabindex="-1"></a>scanf<span class="op">(</span><span class="st">"%d"</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">);</span></span></code></pre></div>
<p><code>scanf()</code> obviously needs a pointer to the variable if it
is going to change the variable itself, so we use the address-of
operator to get the pointer.</p>
<p>In this case, <code>scanf()</code> walks down the format string,
finds a “<code>%d</code>”, and then knows it needs to read an integer
and store it in the next variable in the argument list,
<code>a</code>.</p>
<p>Here are some of the other format specifiers you can put in the
format string:</p>
<table>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Format Specifier</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>%d</code></td>
<td>Reads an integer to be stored in an <code>int</code>. This integer
can be signed.</td>
</tr>
<tr class="even">
<td><code>%u</code></td>
<td>Reads an integer to be stored in an <code>unsigned int</code>.</td>
</tr>
<tr class="odd">
<td><code>%f</code></td>
<td>Reads a floating point number, to be stored in a
<code>float</code>.</td>
</tr>
<tr class="even">
<td><code>%s</code></td>
<td>Reads a string up to the first whitespace character.</td>
</tr>
<tr class="odd">
<td><code>%c</code></td>
<td>Reads a <code>char</code>.</td>
</tr>
</tbody>
</table>
<p>And that’s the end of the story!</p>
<p>Ha! Just kidding. If you’ve just arrived from the
<code>printf()</code> page, you know there’s a near-infinite amount of
additional material.</p>
<h4 data-number="61.11.0.1" id="consuming-other-characters"><span class="header-section-number">61.11.0.1</span> Consuming Other
Characters</h4>
<p><code>scanf()</code> will move along the format string matching any
characters you include.</p>
<p>For example, you could read a hyphenated date like so:</p>
<div class="sourceCode" id="cb1262"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1262-1"><a href="stdio.html#cb1262-1" aria-hidden="true" tabindex="-1"></a>scanf<span class="op">(</span><span class="st">"%u-%u-%u"</span><span class="op">,</span> <span class="op">&amp;</span>yyyy<span class="op">,</span> <span class="op">&amp;</span>mm<span class="op">,</span> <span class="op">&amp;</span>dd<span class="op">);</span></span></code></pre></div>
<p>In that case, <code>scanf()</code> will attempt to consume an
unsigned decimal number, then a hyphen, then another unsigned number,
then another hypen, then another unsigned number.</p>
<p>If it fails to match at any point (e.g.&nbsp;the user entered “foo”),
<code>scanf()</code> will bail without consuming the offending
characters.</p>
<p>And it will return the number of variables successfully converted. In
the example above, if the user entered a valid string,
<code>scanf()</code> would return <code>3</code>, one for each variable
successfully read.</p>
<h4 data-number="61.11.0.2" id="problems-with-scanf"><span class="header-section-number">61.11.0.2</span> Problems with
<code>scanf()</code></h4>
<p>I (and the C FAQ and a lot of people) recommend <em>against</em>
using <code>scanf()</code> to read directly from the keyboard. It’s too
easy for it to stop consuming characters when the user enters some bad
data.</p>
<p>If you have data in a file and you’re confident it’s in good shape,
<code>fscanf()</code> can be really useful.</p>
<p>But in the case of the keyboard or file, you can always use
<code>fgets()</code> to read a complete line into a buffer, and then use
<code>sscanf()</code> to scan things out of the buffer. This gives you
the best of both worlds.</p>
<h4 data-number="61.11.0.3" id="problems-with-sscanf"><span class="header-section-number">61.11.0.3</span> Problems with
<code>sscanf()</code></h4>
<p>A while back, a third-party programmer rose to fame for figuring out
<a href="https://nee.lv/2021/02/28/How-I-cut-GTA-Online-loading-times-by-70/">how
to cut <em>GTA Online</em> load times by 70%</a><a href="footnotes.html#fn255" class="footnote-ref" id="fnref255" role="doc-noteref"><sup>255</sup></a>.</p>
<p>What they’d discovered was that the implementation of
<code>sscanf()</code> first effectively calls <code>strlen()</code>… so
even if you’re just using <code>sscanf()</code> to peel the first few
characters off the string, it still runs all the way out to the end of
the string first.</p>
<p>On small strings, no big deal, but on large strings with repeated
calls (which is what was happening in <em>GTA</em>) it got
<em>sloooooooooowwwww</em>…</p>
<p>So if you’re just converting a string to a number, consider <a href="#man-atoi"><code>atoi()</code></a>, <a href="#man-atof"><code>atof()</code></a>, or the <a href="#man-strtol"><code>strtol()</code></a> and <a href="#man-strtod"><code>strtod()</code></a> families of functions,
instead.</p>
<p>(The programmer <a href="https://www.polygon.com/2021/3/16/22334214/gta-online-loading-times-t0st-update-bug-bounty">collected
a $10,000 bug bounty</a> for the effort.)</p>
<h4 data-number="61.11.0.4" id="the-deep-details"><span class="header-section-number">61.11.0.4</span> The Deep Details</h4>
<p>Let’s check out what a <code>scanf()</code></p>
<p>And here are some more codes, except these don’t tend to be used as
often. You, of course, may use them as often as you wish!</p>
<p>First, the format string. Like we mentioned, it can hold ordinary
characters as well as <code>%</code> format specifiers. And whitespace
characters.</p>
<p>Whitespace characters have a special role: a whitespace character
will cause <code>scanf()</code> to consume as many whitespace characters
as it can up to the next non-whitespace character. You can use this to
ignore all leading or trailing whitespace.</p>
<p>Also, all format specifiers except for <code>s</code>,
<code>c</code>, and <code>[</code> automatically consume leading
whitespace.</p>
<p>But I know what you’re thinking: the meat of this function is in the
format specifiers. What do those look like?</p>
<p>These consist of the following, in sequence:</p>
<ol type="1">
<li>A <code>%</code> sign</li>
<li>Optional: an <code>*</code> to suppress assignment—more later</li>
<li>Optional: a field width—max characters to read</li>
<li>Optional: length modifier, for specifying longer or shorter
types</li>
<li>A conversion specifier, like <code>d</code> or <code>f</code>
indicating the type to read</li>
</ol>
<h4 data-number="61.11.0.5" id="the-conversion-specifier"><span class="header-section-number">61.11.0.5</span> The Conversion
Specifier</h4>
<p>Let’s start with the best and last: the <em>conversion
specifier</em>.</p>
<p>This is the part of the format specifier that tells us what type of
variable <code>scanf()</code> should be reading into, like
<code>%d</code> or <code>%f</code>.</p>
<table>
<colgroup>
<col style="width: 13%">
<col style="width: 86%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Conversion Specifier</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>d</code></td>
<td>Matches a decimal <code>int</code>. Can have a leading sign.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>i</code></td>
<td>Like <code>d</code>, except will handle it if you put a leading
<code>0x</code> (hex) or <code>0</code> (octal) on the number.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>o</code></td>
<td>Matches an octal (base 8) <code>unsigned int</code>. Leading zeros
are ignored.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>u</code></td>
<td>Matches a decimal <code>unsigned int</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>x</code></td>
<td>Matches a hex (base 16) <code>unsigned int</code>.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>f</code></td>
<td>Match a floating point number (or scientific notation, or anything
<code>strtod()</code> can handle).</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>c</code></td>
<td>Match a <code>char</code>, or mutiple <code>char</code>s if a field
width is given.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>s</code></td>
<td>Match a sequence of non-whitespace <code>char</code>s.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>[</code></td>
<td>Match a sequence of characters from a set. The set ends with
<code>]</code>. More below.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>p</code></td>
<td>Match a pointer, the opposite of <code>%p</code> for
<code>printf()</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>n</code></td>
<td>Store the number of characters written so far in the given
<code>int*</code>. Doesn’t consume anything.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>%</code></td>
<td>Match a literal percent sign.</td>
</tr>
</tbody>
</table>
<p>All of the following are equivalent to the <code>f</code> specifier:
<code>a</code>, <code>e</code>, <code>g</code>, <code>A</code>,
<code>E</code>, <code>F</code>, <code>G</code>.</p>
<p>And capital <code>X</code> is equivalent to lowercase
<code>x</code>.</p>
<h5 data-number="61.11.0.5.1" id="the-scanset-conversion-specifier"><span class="header-section-number">61.11.0.5.1</span> The Scanset
<code>%[]</code> Conversion Specifier</h5>
<p>This is about the weirdest format specifier there is. It allows you
to specify a set of characters (the <em>scanset</em>) to be stored away
(likely in an array of <code>char</code>s). Conversion stops when a
character that is not in the set is matched.</p>
<p>For example, <code>%[0-9]</code> means “match all numbers zero
through nine.” And <code>%[AD-G34]</code> means “match A, D through G,
3, or 4”.</p>
<p>Now, to convolute matters, you can tell <code>scanf()</code> to match
characters that are <em>not</em> in the set by putting a caret
(<code>^</code>) directly after the <code>%[</code> and following it
with the set, like this: <code>%[^A-C]</code>, which means “match all
characters that are <em>not</em> A through C.”</p>
<p>To match a close square bracket, make it the first character in the
set, like this: <code>%[]A-C]</code> or <code>%[^]A-C]</code>. (I added
the “<code>A-C</code>” just so it was clear that the “<code>]</code>”
was first in the set.)</p>
<p>To match a hyphen, make it the last character in the set, e.g.&nbsp;to
match A-through-C or hyphen: <code>%[A-C-]</code>.</p>
<p>So if we wanted to match all letters <em>except</em> “%”, “^”, “]”,
“B”, “C”, “D”, “E”, and “-”, we could use this format string:
<code>%[^]%^B-E-]</code>.</p>
<p>Got it? Now we can go onto the next func—no wait! There’s more! Yes,
still more to know about <code>scanf()</code>. Does it never end? Try to
imagine how I feel writing about it!</p>
<h4 data-number="61.11.0.6" id="the-length-modifier"><span class="header-section-number">61.11.0.6</span> The Length Modifier</h4>
<p>So you know that “<code>%d</code>” stores into an <code>int</code>.
But how do you store into a <code>long</code>, <code>short</code>, or
<code>double</code>?</p>
<p>Well, like in <code>printf()</code>, you can add a modifier before
the type specifier to tell <code>scanf()</code> that you have a longer
or shorter type. The following is a table of the possible modifiers:</p>
<table>
<colgroup>
<col style="width: 13%">
<col style="width: 24%">
<col style="width: 62%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Length Modifier</th>
<th style="text-align: center;">Conversion Specifier</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>hh</code></td>
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>Convert input to <code>char</code> (signed or unsigned as
appropriate) before printing.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>h</code></td>
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>Convert input to <code>short int</code> (signed or unsigned as
appropriate) before printing.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>l</code></td>
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>Convert input to <code>long int</code> (signed or unsigned as
appropriate).</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>ll</code></td>
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>Convert input to <code>long long int</code> (signed or unsigned as
appropriate).</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>j</code></td>
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>Convert input to <code>intmax_t</code> or <code>uintmax_t</code> (as
appropriate).</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>z</code></td>
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>Convert input to <code>size_t</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>t</code></td>
<td style="text-align: center;"><code>d</code>, <code>i</code>,
<code>o</code>, <code>u</code>, <code>x</code>, <code>X</code></td>
<td>Convert input to <code>ptrdiff_t</code>.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>L</code></td>
<td style="text-align: center;"><code>a</code>, <code>A</code>,
<code>e</code>, <code>E</code>, <code>f</code>, <code>F</code>,
<code>g</code>, <code>G</code></td>
<td>Convert input to <code>long double</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>l</code></td>
<td style="text-align: center;"><code>c</code>,<code>s</code>,<code>[</code></td>
<td>Convert input to <code>wchar_t</code>, a wide character.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>l</code></td>
<td style="text-align: center;"><code>s</code></td>
<td>Argument is in a <code>wchar_t*</code>, a wide character
string.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>hh</code></td>
<td style="text-align: center;"><code>n</code></td>
<td>Store result in <code>signed char*</code> argument.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>h</code></td>
<td style="text-align: center;"><code>n</code></td>
<td>Store result in <code>short int*</code> argument.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>l</code></td>
<td style="text-align: center;"><code>n</code></td>
<td>Store result in <code>long int*</code> argument.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>ll</code></td>
<td style="text-align: center;"><code>n</code></td>
<td>Store result in <code>long long int*</code> argument.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>j</code></td>
<td style="text-align: center;"><code>n</code></td>
<td>Store result in <code>intmax_t*</code> argument.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>z</code></td>
<td style="text-align: center;"><code>n</code></td>
<td>Store result in <code>size_t*</code> argument.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>t</code></td>
<td style="text-align: center;"><code>n</code></td>
<td>Store result in <code>ptrdiff_t*</code> argument.</td>
</tr>
</tbody>
</table>
<h4 data-number="61.11.0.7" id="field-widths"><span class="header-section-number">61.11.0.7</span> Field Widths</h4>
<p>The field width generally allows you to specify a maximum number of
characters to consume. If the thing you’re trying to match is shorter
than the field width, that input will stop being processed before the
field width is reached.</p>
<p>So a string will stop being consumed when whitespace is found, even
if fewer than the field width characters are matched.</p>
<p>And a float will stop being consumed at the end of the number, even
if fewer characters than the field width are matched.</p>
<p>But <code>%c</code> is an interesting one—it doesn’t stop consuming
characters on anything. So it’ll go exactly to the field width. (Or 1
character if no field width is given.)</p>
<h4 data-number="61.11.0.8" id="skip-input-with"><span class="header-section-number">61.11.0.8</span> Skip Input with
<code>*</code></h4>
<p>If you put an <code>*</code> in the format specifier, it tells
<code>scanf()</code> do to the conversion specified, but not store it
anywhere. It simply discards the data as it reads it. This is what you
use if you want <code>scanf()</code> to eat some data but you don’t want
to store it anywhere; you don’t give <code>scanf()</code> an argument
for this conversion.</p>
<div class="sourceCode" id="cb1263"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1263-1"><a href="stdio.html#cb1263-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Read 3 ints, but discard the middle one</span></span>
<span id="cb1263-2"><a href="stdio.html#cb1263-2" aria-hidden="true" tabindex="-1"></a>scanf<span class="op">(</span><span class="st">"%d %*d %d"</span><span class="op">,</span> <span class="op">&amp;</span>int1<span class="op">,</span> <span class="op">&amp;</span>int3<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="return-value-143">Return Value</h3>
<p><code>scanf()</code> returns the number of items assigned into
variables. Since assignment into variables stops when given invalid
input for a certain format specifier, this can tell you if you’ve input
all your data correctly.</p>
<p>Also, <code>scanf()</code> returns <code>EOF</code> on
end-of-file.</p>
<h3 class="unnumbered unlisted" id="example-146">Example</h3>
<div class="sourceCode" id="cb1264"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1264-1"><a href="stdio.html#cb1264-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1264-2"><a href="stdio.html#cb1264-2"></a></span>
<span id="cb1264-3"><a href="stdio.html#cb1264-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1264-4"><a href="stdio.html#cb1264-4"></a><span class="op">{</span></span>
<span id="cb1264-5"><a href="stdio.html#cb1264-5"></a>    <span class="dt">int</span> a<span class="op">;</span></span>
<span id="cb1264-6"><a href="stdio.html#cb1264-6"></a>    <span class="dt">long</span> <span class="dt">int</span> b<span class="op">;</span></span>
<span id="cb1264-7"><a href="stdio.html#cb1264-7"></a>    <span class="dt">unsigned</span> <span class="dt">int</span> c<span class="op">;</span></span>
<span id="cb1264-8"><a href="stdio.html#cb1264-8"></a>    <span class="dt">float</span> d<span class="op">;</span></span>
<span id="cb1264-9"><a href="stdio.html#cb1264-9"></a>    <span class="dt">double</span> e<span class="op">;</span></span>
<span id="cb1264-10"><a href="stdio.html#cb1264-10"></a>    <span class="dt">long</span> <span class="dt">double</span> f<span class="op">;</span></span>
<span id="cb1264-11"><a href="stdio.html#cb1264-11"></a>    <span class="dt">char</span> s<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb1264-12"><a href="stdio.html#cb1264-12"></a></span>
<span id="cb1264-13"><a href="stdio.html#cb1264-13"></a>    scanf<span class="op">(</span><span class="st">"%d"</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">);</span>  <span class="co">// store an int</span></span>
<span id="cb1264-14"><a href="stdio.html#cb1264-14"></a>    scanf<span class="op">(</span><span class="st">" %d"</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">);</span> <span class="co">// eat any whitespace, then store an int</span></span>
<span id="cb1264-15"><a href="stdio.html#cb1264-15"></a>    scanf<span class="op">(</span><span class="st">"%s"</span><span class="op">,</span> s<span class="op">);</span> <span class="co">// store a string</span></span>
<span id="cb1264-16"><a href="stdio.html#cb1264-16"></a>    scanf<span class="op">(</span><span class="st">"%Lf"</span><span class="op">,</span> <span class="op">&amp;</span>f<span class="op">);</span> <span class="co">// store a long double</span></span>
<span id="cb1264-17"><a href="stdio.html#cb1264-17"></a></span>
<span id="cb1264-18"><a href="stdio.html#cb1264-18"></a>    <span class="co">// store an unsigned, read all whitespace, then store a long int:</span></span>
<span id="cb1264-19"><a href="stdio.html#cb1264-19"></a>    scanf<span class="op">(</span><span class="st">"%u %ld"</span><span class="op">,</span> <span class="op">&amp;</span>c<span class="op">,</span> <span class="op">&amp;</span>b<span class="op">);</span></span>
<span id="cb1264-20"><a href="stdio.html#cb1264-20"></a></span>
<span id="cb1264-21"><a href="stdio.html#cb1264-21"></a>    <span class="co">// store an int, read whitespace, read "blendo", read whitespace,</span></span>
<span id="cb1264-22"><a href="stdio.html#cb1264-22"></a>    <span class="co">// and store a float:</span></span>
<span id="cb1264-23"><a href="stdio.html#cb1264-23"></a>    scanf<span class="op">(</span><span class="st">"%d blendo %f"</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">,</span> <span class="op">&amp;</span>d<span class="op">);</span></span>
<span id="cb1264-24"><a href="stdio.html#cb1264-24"></a></span>
<span id="cb1264-25"><a href="stdio.html#cb1264-25"></a>    <span class="co">// read all whitespace, then store all characters up to a newline</span></span>
<span id="cb1264-26"><a href="stdio.html#cb1264-26"></a>    scanf<span class="op">(</span><span class="st">" %[^</span><span class="sc">\n</span><span class="st">]"</span><span class="op">,</span> s<span class="op">);</span></span>
<span id="cb1264-27"><a href="stdio.html#cb1264-27"></a></span>
<span id="cb1264-28"><a href="stdio.html#cb1264-28"></a>    <span class="co">// store a float, read (and ignore) an int, then store a double:</span></span>
<span id="cb1264-29"><a href="stdio.html#cb1264-29"></a>    scanf<span class="op">(</span><span class="st">"%f %*d %lf"</span><span class="op">,</span> <span class="op">&amp;</span>d<span class="op">,</span> <span class="op">&amp;</span>e<span class="op">);</span></span>
<span id="cb1264-30"><a href="stdio.html#cb1264-30"></a></span>
<span id="cb1264-31"><a href="stdio.html#cb1264-31"></a>    <span class="co">// store 10 characters:</span></span>
<span id="cb1264-32"><a href="stdio.html#cb1264-32"></a>    scanf<span class="op">(</span><span class="st">"%10c"</span><span class="op">,</span> s<span class="op">);</span></span>
<span id="cb1264-33"><a href="stdio.html#cb1264-33"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-137">See Also</h3>
<p><a href="stdio.html#man-scanf"><code>sscanf()</code></a>, <a href="#man-vscanf"><code>vscanf()</code></a>, <a href="#man-vscanf"><code>vsscanf()</code></a>, <a href="#man-vscanf"><code>vfscanf()</code></a></p>
<hr>
<h2 data-number="61.12" id="man-vprintf"><span class="header-section-number">61.12</span> <code>vprintf()</code>,
<code>vfprintf()</code>, <code>vsprintf()</code>,
<code>vsnprintf()</code></h2>
<p><code>printf()</code> variants using variable argument lists
(<code>va_list</code>)</p>
<h3 class="unnumbered unlisted" id="synopsis-146">Synopsis</h3>
<div class="sourceCode" id="cb1265"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1265-1"><a href="stdio.html#cb1265-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1265-2"><a href="stdio.html#cb1265-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdarg.h&gt;</span></span>
<span id="cb1265-3"><a href="stdio.html#cb1265-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1265-4"><a href="stdio.html#cb1265-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> vprintf<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> format<span class="op">,</span> <span class="dt">va_list</span> arg<span class="op">);</span></span>
<span id="cb1265-5"><a href="stdio.html#cb1265-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1265-6"><a href="stdio.html#cb1265-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> vfprintf<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span> <span class="dt">restrict</span> stream<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> format<span class="op">,</span></span>
<span id="cb1265-7"><a href="stdio.html#cb1265-7" aria-hidden="true" tabindex="-1"></a>             <span class="dt">va_list</span> arg<span class="op">);</span></span>
<span id="cb1265-8"><a href="stdio.html#cb1265-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1265-9"><a href="stdio.html#cb1265-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> vsprintf<span class="op">(</span><span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> s<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> format<span class="op">,</span> <span class="dt">va_list</span> arg<span class="op">);</span></span>
<span id="cb1265-10"><a href="stdio.html#cb1265-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1265-11"><a href="stdio.html#cb1265-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> vsnprintf<span class="op">(</span><span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> s<span class="op">,</span> <span class="dt">size_t</span> n<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> format<span class="op">,</span></span>
<span id="cb1265-12"><a href="stdio.html#cb1265-12" aria-hidden="true" tabindex="-1"></a>              <span class="dt">va_list</span> arg<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-146">Description</h3>
<p>These are just like the <code>printf()</code> variants except instead
of taking an actual variable number of arguments, they take a fixed
number—the last of which is a <code>va_list</code> that refers to the
variable arguments.</p>
<p>Like with <code>printf()</code>, the different variants send output
different places.</p>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>Output Destination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>vprintf()</code></td>
<td>Print to console (screen by default, typically).</td>
</tr>
<tr class="even">
<td><code>vfprintf()</code></td>
<td>Print to a file.</td>
</tr>
<tr class="odd">
<td><code>vsprintf()</code></td>
<td>Print to a string.</td>
</tr>
<tr class="even">
<td><code>vsnprintf()</code></td>
<td>Print to a string (safely).</td>
</tr>
</tbody>
</table>
<p>Both <code>vsprintf()</code> and <code>vsnprintf()</code> have the
quality that if you pass in <code>NULL</code> as the buffer, nothing is
written—but you can still check the return value to see how many
characters <em>would</em> have been written.</p>
<p>If you try to write out more than the maximum number of characters,
<code>vsnprintf()</code> will graciously write only <span class="math inline"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="5" style="font-size: 103.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>−</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span> characters so that it has enough room
to write the terminator at the end.</p>
<p>As for why in the heck would you ever want to do this, the most
common reason is to create your own specialized versions of
<code>printf()</code>-type functions, piggybacking on all that
<code>printf()</code> functionality goodness.</p>
<p>See the example for an example, predictably.</p>
<h3 class="unnumbered unlisted" id="return-value-144">Return Value</h3>
<p><code>vprintf()</code> and <code>vfprintf()</code> return the number
of characters printed, or a negative value on error.</p>
<p><code>vsprintf()</code> returns the number of characters printed to
the buffer, not counting the NUL terminator, or a negative value if an
error occurred.</p>
<p><code>vnsprintf()</code> returns the number of characters printed to
the buffer. Or the number that <em>would</em> have been printed if the
buffer had been large enough.</p>
<h3 class="unnumbered unlisted" id="example-147">Example</h3>
<p>In this example, we make our own version of <code>printf()</code>
called <code>logger()</code> that timestamps output. Notice how the
calls to <code>logger()</code> have all the bells and whistles of
<code>printf()</code>.</p>
<div class="sourceCode" id="cb1266"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1266-1"><a href="stdio.html#cb1266-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1266-2"><a href="stdio.html#cb1266-2"></a><span class="pp">#include </span><span class="im">&lt;stdarg.h&gt;</span></span>
<span id="cb1266-3"><a href="stdio.html#cb1266-3"></a><span class="pp">#include </span><span class="im">&lt;time.h&gt;</span></span>
<span id="cb1266-4"><a href="stdio.html#cb1266-4"></a></span>
<span id="cb1266-5"><a href="stdio.html#cb1266-5"></a><span class="dt">int</span> logger<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>format<span class="op">,</span> <span class="op">...)</span></span>
<span id="cb1266-6"><a href="stdio.html#cb1266-6"></a><span class="op">{</span></span>
<span id="cb1266-7"><a href="stdio.html#cb1266-7"></a>    <span class="dt">va_list</span> va<span class="op">;</span></span>
<span id="cb1266-8"><a href="stdio.html#cb1266-8"></a>    <span class="dt">time_t</span> now_secs <span class="op">=</span> time<span class="op">(</span>NULL<span class="op">);</span></span>
<span id="cb1266-9"><a href="stdio.html#cb1266-9"></a>    <span class="kw">struct</span> tm <span class="op">*</span>now <span class="op">=</span> gmtime<span class="op">(&amp;</span>now_secs<span class="op">);</span></span>
<span id="cb1266-10"><a href="stdio.html#cb1266-10"></a></span>
<span id="cb1266-11"><a href="stdio.html#cb1266-11"></a>    <span class="co">// Output timestamp in format "YYYY-MM-DD hh:mm:ss : "</span></span>
<span id="cb1266-12"><a href="stdio.html#cb1266-12"></a>    printf<span class="op">(</span><span class="st">"%04d-%02d-%02d %02d:%02d:%02d : "</span><span class="op">,</span></span>
<span id="cb1266-13"><a href="stdio.html#cb1266-13"></a>        now<span class="op">-&gt;</span>tm_year <span class="op">+</span> <span class="dv">1900</span><span class="op">,</span> now<span class="op">-&gt;</span>tm_mon <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> now<span class="op">-&gt;</span>tm_mday<span class="op">,</span></span>
<span id="cb1266-14"><a href="stdio.html#cb1266-14"></a>        now<span class="op">-&gt;</span>tm_hour<span class="op">,</span> now<span class="op">-&gt;</span>tm_min<span class="op">,</span> now<span class="op">-&gt;</span>tm_sec<span class="op">);</span></span>
<span id="cb1266-15"><a href="stdio.html#cb1266-15"></a></span>
<span id="cb1266-16"><a href="stdio.html#cb1266-16"></a>    va_start<span class="op">(</span>va<span class="op">,</span> format<span class="op">);</span></span>
<span id="cb1266-17"><a href="stdio.html#cb1266-17"></a>    <span class="dt">int</span> result <span class="op">=</span> vprintf<span class="op">(</span>format<span class="op">,</span> va<span class="op">);</span></span>
<span id="cb1266-18"><a href="stdio.html#cb1266-18"></a>    va_end<span class="op">(</span>va<span class="op">);</span></span>
<span id="cb1266-19"><a href="stdio.html#cb1266-19"></a></span>
<span id="cb1266-20"><a href="stdio.html#cb1266-20"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1266-21"><a href="stdio.html#cb1266-21"></a></span>
<span id="cb1266-22"><a href="stdio.html#cb1266-22"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb1266-23"><a href="stdio.html#cb1266-23"></a><span class="op">}</span></span>
<span id="cb1266-24"><a href="stdio.html#cb1266-24"></a></span>
<span id="cb1266-25"><a href="stdio.html#cb1266-25"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1266-26"><a href="stdio.html#cb1266-26"></a><span class="op">{</span></span>
<span id="cb1266-27"><a href="stdio.html#cb1266-27"></a>    <span class="dt">int</span> x <span class="op">=</span> <span class="dv">12</span><span class="op">;</span></span>
<span id="cb1266-28"><a href="stdio.html#cb1266-28"></a>    <span class="dt">float</span> y <span class="op">=</span> <span class="fl">3.2</span><span class="op">;</span></span>
<span id="cb1266-29"><a href="stdio.html#cb1266-29"></a></span>
<span id="cb1266-30"><a href="stdio.html#cb1266-30"></a>    logger<span class="op">(</span><span class="st">"Hello!"</span><span class="op">);</span></span>
<span id="cb1266-31"><a href="stdio.html#cb1266-31"></a>    logger<span class="op">(</span><span class="st">"x = %d and y = %.2f"</span><span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb1266-32"><a href="stdio.html#cb1266-32"></a><span class="op">}</span></span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb1267"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb1267-1"><a href="stdio.html#cb1267-1" aria-hidden="true" tabindex="-1"></a>2021-03-30 04:25:49 : Hello!</span>
<span id="cb1267-2"><a href="stdio.html#cb1267-2" aria-hidden="true" tabindex="-1"></a>2021-03-30 04:25:49 : x = 12 and y = 3.20</span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-138">See Also</h3>
<p><a href="stdio.html#man-printf"><code>printf()</code></a></p>
<hr>
<h2 data-number="61.13" id="man-vscanf"><span class="header-section-number">61.13</span> <code>vscanf()</code>,
<code>vfscanf()</code>, <code>vsscanf()</code></h2>
<p><code>scanf()</code> variants using variable argument lists
(<code>va_list</code>)</p>
<h3 class="unnumbered unlisted" id="synopsis-147">Synopsis</h3>
<div class="sourceCode" id="cb1268"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1268-1"><a href="stdio.html#cb1268-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1268-2"><a href="stdio.html#cb1268-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdarg.h&gt;</span></span>
<span id="cb1268-3"><a href="stdio.html#cb1268-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1268-4"><a href="stdio.html#cb1268-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> vscanf<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> format<span class="op">,</span> <span class="dt">va_list</span> arg<span class="op">);</span></span>
<span id="cb1268-5"><a href="stdio.html#cb1268-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1268-6"><a href="stdio.html#cb1268-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> vfscanf<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span> <span class="dt">restrict</span> stream<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> format<span class="op">,</span></span>
<span id="cb1268-7"><a href="stdio.html#cb1268-7" aria-hidden="true" tabindex="-1"></a>            <span class="dt">va_list</span> arg<span class="op">);</span></span>
<span id="cb1268-8"><a href="stdio.html#cb1268-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1268-9"><a href="stdio.html#cb1268-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> vsscanf<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> s<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> <span class="dt">restrict</span> format<span class="op">,</span></span>
<span id="cb1268-10"><a href="stdio.html#cb1268-10" aria-hidden="true" tabindex="-1"></a>            <span class="dt">va_list</span> arg<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-147">Description</h3>
<p>These are just like the <code>scanf()</code> variants except instead
of taking an actual variable number of arguments, they take a fixed
number—the last of which is a <code>va_list</code> that refers to the
variable arguments.</p>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>Input Source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>vscanf()</code></td>
<td>Read from the console (keyboard by default, typically).</td>
</tr>
<tr class="even">
<td><code>vfscanf()</code></td>
<td>Read from a file.</td>
</tr>
<tr class="odd">
<td><code>vsscanf()</code></td>
<td>Read from a string.</td>
</tr>
</tbody>
</table>
<p>Like with the <code>vprintf()</code> functions, this would be a good
way to add additional functionality that took advantage of the power
<code>scanf()</code> has to offer.</p>
<h3 class="unnumbered unlisted" id="return-value-145">Return Value</h3>
<p>Returns the number of items successfully scanned, or <code>EOF</code>
on end-of-file or error.</p>
<h3 class="unnumbered unlisted" id="example-148">Example</h3>
<p>I have to admit I was wracking my brain to think of when you’d ever
want to use this. The best example I could find was <a href="https://stackoverflow.com/questions/17017331/c99-vscanf-for-dummies/17018046#17018046">one
on Stack Overflow</a><a href="footnotes.html#fn256" class="footnote-ref" id="fnref256" role="doc-noteref"><sup>256</sup></a> that error-checks the return value
from <code>scanf()</code> against the expected. A variant of that is
shown below.</p>
<div class="sourceCode" id="cb1269"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1269-1"><a href="stdio.html#cb1269-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1269-2"><a href="stdio.html#cb1269-2"></a><span class="pp">#include </span><span class="im">&lt;stdarg.h&gt;</span></span>
<span id="cb1269-3"><a href="stdio.html#cb1269-3"></a><span class="pp">#include </span><span class="im">&lt;assert.h&gt;</span></span>
<span id="cb1269-4"><a href="stdio.html#cb1269-4"></a></span>
<span id="cb1269-5"><a href="stdio.html#cb1269-5"></a><span class="dt">int</span> error_check_scanf<span class="op">(</span><span class="dt">int</span> expected_count<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>format<span class="op">,</span> <span class="op">...)</span></span>
<span id="cb1269-6"><a href="stdio.html#cb1269-6"></a><span class="op">{</span></span>
<span id="cb1269-7"><a href="stdio.html#cb1269-7"></a>    <span class="dt">va_list</span> va<span class="op">;</span></span>
<span id="cb1269-8"><a href="stdio.html#cb1269-8"></a></span>
<span id="cb1269-9"><a href="stdio.html#cb1269-9"></a>    va_start<span class="op">(</span>va<span class="op">,</span> format<span class="op">);</span></span>
<span id="cb1269-10"><a href="stdio.html#cb1269-10"></a>    <span class="dt">int</span> count <span class="op">=</span> vscanf<span class="op">(</span>format<span class="op">,</span> va<span class="op">);</span></span>
<span id="cb1269-11"><a href="stdio.html#cb1269-11"></a>    va_end<span class="op">(</span>va<span class="op">);</span></span>
<span id="cb1269-12"><a href="stdio.html#cb1269-12"></a></span>
<span id="cb1269-13"><a href="stdio.html#cb1269-13"></a>    <span class="co">// This line will crash the program if the condition is false:</span></span>
<span id="cb1269-14"><a href="stdio.html#cb1269-14"></a>    assert<span class="op">(</span>count <span class="op">==</span> expected_count<span class="op">);</span></span>
<span id="cb1269-15"><a href="stdio.html#cb1269-15"></a></span>
<span id="cb1269-16"><a href="stdio.html#cb1269-16"></a>    <span class="cf">return</span> count<span class="op">;</span></span>
<span id="cb1269-17"><a href="stdio.html#cb1269-17"></a><span class="op">}</span></span>
<span id="cb1269-18"><a href="stdio.html#cb1269-18"></a></span>
<span id="cb1269-19"><a href="stdio.html#cb1269-19"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1269-20"><a href="stdio.html#cb1269-20"></a><span class="op">{</span></span>
<span id="cb1269-21"><a href="stdio.html#cb1269-21"></a>    <span class="dt">int</span> a<span class="op">,</span> b<span class="op">;</span></span>
<span id="cb1269-22"><a href="stdio.html#cb1269-22"></a>    <span class="dt">float</span> c<span class="op">;</span></span>
<span id="cb1269-23"><a href="stdio.html#cb1269-23"></a></span>
<span id="cb1269-24"><a href="stdio.html#cb1269-24"></a>    error_check_scanf<span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="st">"%d, %d/%f"</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">,</span> <span class="op">&amp;</span>b<span class="op">,</span> <span class="op">&amp;</span>c<span class="op">);</span></span>
<span id="cb1269-25"><a href="stdio.html#cb1269-25"></a>    error_check_scanf<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="st">"%d"</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">);</span></span>
<span id="cb1269-26"><a href="stdio.html#cb1269-26"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-139">See Also</h3>
<p><a href="stdio.html#man-scanf"><code>scanf()</code></a></p>
<hr>
<h2 data-number="61.14" id="man-getc"><span class="header-section-number">61.14</span> <code>getc()</code>,
<code>fgetc()</code>, <code>getchar()</code></h2>
<p>Get a single character from the console or from a file</p>
<h3 class="unnumbered unlisted" id="synopsis-148">Synopsis</h3>
<div class="sourceCode" id="cb1270"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1270-1"><a href="stdio.html#cb1270-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1270-2"><a href="stdio.html#cb1270-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1270-3"><a href="stdio.html#cb1270-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> getc<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span>
<span id="cb1270-4"><a href="stdio.html#cb1270-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1270-5"><a href="stdio.html#cb1270-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fgetc<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span>
<span id="cb1270-6"><a href="stdio.html#cb1270-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1270-7"><a href="stdio.html#cb1270-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> getchar<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-148">Description</h3>
<p>All of these functions in one way or another, read a single character
from the console or from a <code>FILE</code>. The differences are fairly
minor, and here are the descriptions:</p>
<p><code>getc()</code> returns a character from the specified
<code>FILE</code>. From a usage standpoint, it’s equivalent to the same
<code>fgetc()</code> call, and <code>fgetc()</code> is a little more
common to see. Only the implementation of the two functions differs.</p>
<p><code>fgetc()</code> returns a character from the specified
<code>FILE</code>. From a usage standpoint, it’s equivalent to the same
<code>getc()</code> call, except that <code>fgetc()</code> is a little
more common to see. Only the implementation of the two functions
differs.</p>
<p>Yes, I cheated and used cut-n-paste to do that last paragraph.</p>
<p><code>getchar()</code> returns a character from <code>stdin</code>.
In fact, it’s the same as calling <code>getc(stdin)</code>.</p>
<h3 class="unnumbered unlisted" id="return-value-146">Return Value</h3>
<p>All three functions return the <code>unsigned char</code> that they
read, except it’s cast to an <code>int</code>.</p>
<p>If end-of-file or an error is encountered, all three functions return
<code>EOF</code>.</p>
<h3 class="unnumbered unlisted" id="example-149">Example</h3>
<p>This example reads all the characters from a file, outputting only
the letter ’b’s it finds..</p>
<div class="sourceCode" id="cb1271"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1271-1"><a href="stdio.html#cb1271-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1271-2"><a href="stdio.html#cb1271-2"></a></span>
<span id="cb1271-3"><a href="stdio.html#cb1271-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1271-4"><a href="stdio.html#cb1271-4"></a><span class="op">{</span></span>
<span id="cb1271-5"><a href="stdio.html#cb1271-5"></a>    <span class="dt">FILE</span> <span class="op">*</span>fp<span class="op">;</span></span>
<span id="cb1271-6"><a href="stdio.html#cb1271-6"></a>    <span class="dt">int</span> c<span class="op">;</span></span>
<span id="cb1271-7"><a href="stdio.html#cb1271-7"></a></span>
<span id="cb1271-8"><a href="stdio.html#cb1271-8"></a>    fp <span class="op">=</span> fopen<span class="op">(</span><span class="st">"spoon.txt"</span><span class="op">,</span> <span class="st">"r"</span><span class="op">);</span> <span class="co">// error check this!</span></span>
<span id="cb1271-9"><a href="stdio.html#cb1271-9"></a></span>
<span id="cb1271-10"><a href="stdio.html#cb1271-10"></a>    <span class="co">// this while-statement assigns into c, and then checks against EOF:</span></span>
<span id="cb1271-11"><a href="stdio.html#cb1271-11"></a></span>
<span id="cb1271-12"><a href="stdio.html#cb1271-12"></a>    <span class="cf">while</span><span class="op">((</span>c <span class="op">=</span> fgetc<span class="op">(</span>fp<span class="op">))</span> <span class="op">!=</span> EOF<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1271-13"><a href="stdio.html#cb1271-13"></a>        <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="ch">'b'</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1271-14"><a href="stdio.html#cb1271-14"></a>            putchar<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb1271-15"><a href="stdio.html#cb1271-15"></a>        <span class="op">}</span></span>
<span id="cb1271-16"><a href="stdio.html#cb1271-16"></a>    <span class="op">}</span></span>
<span id="cb1271-17"><a href="stdio.html#cb1271-17"></a></span>
<span id="cb1271-18"><a href="stdio.html#cb1271-18"></a>    putchar<span class="op">(</span><span class="ch">'\n'</span><span class="op">);</span></span>
<span id="cb1271-19"><a href="stdio.html#cb1271-19"></a></span>
<span id="cb1271-20"><a href="stdio.html#cb1271-20"></a>    fclose<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb1271-21"><a href="stdio.html#cb1271-21"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-140">See Also</h3>
<hr>
<h2 data-number="61.15" id="man-gets"><span class="header-section-number">61.15</span> <code>gets()</code>,
<code>fgets()</code></h2>
<p>Read a string from console or file</p>
<h3 class="unnumbered unlisted" id="synopsis-149">Synopsis</h3>
<div class="sourceCode" id="cb1272"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1272-1"><a href="stdio.html#cb1272-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1272-2"><a href="stdio.html#cb1272-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1272-3"><a href="stdio.html#cb1272-3" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> <span class="op">*</span>fgets<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>s<span class="op">,</span> <span class="dt">int</span> size<span class="op">,</span> <span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span>
<span id="cb1272-4"><a href="stdio.html#cb1272-4" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> <span class="op">*</span>gets<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>s<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-149">Description</h3>
<p>These are functions that will retrieve a newline-terminated string
from the console or a file. In other normal words, it reads a line of
text. The behavior is slightly different, and, as such, so is the usage.
For instance, here is the usage of <code>gets()</code>:</p>
<p>Don’t use <code>gets()</code>. In fact, as of C11, it ceases to
exist! This is one of the rare cases of a function being
<em>removed</em> from the standard.</p>
<p>Admittedly, rationale would be useful, yes? For one thing,
<code>gets()</code> doesn’t allow you to specify the length of the
buffer to store the string in. This would allow people to keep entering
data past the end of your buffer, and believe me, this would be Bad
News.</p>
<p>And that’s what the <code>size</code> parameter in
<code>fgets()</code> is for. <code>fgets()</code> will read at most
<code>size-1</code> characters and then stick a <code>NUL</code>
terminator on after that.</p>
<p>I was going to add another reason, but that’s basically the primary
and only reason not to use <code>gets()</code>. As you might suspect,
<code>fgets()</code> allows you to specify a maximum string length.</p>
<p>One difference here between the two functions: <code>gets()</code>
will devour and throw away the newline at the end of the line, while
<code>fgets()</code> will store it at the end of your string (space
permitting).</p>
<p>Here’s an example of using <code>fgets()</code> from the console,
making it behave more like <code>gets()</code> (with the exception of
the newline inclusion):</p>
<div class="sourceCode" id="cb1273"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1273-1"><a href="stdio.html#cb1273-1" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> s<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb1273-2"><a href="stdio.html#cb1273-2" aria-hidden="true" tabindex="-1"></a>gets<span class="op">(</span>s<span class="op">);</span>  <span class="co">// don't use this--read a line (from stdin)</span></span>
<span id="cb1273-3"><a href="stdio.html#cb1273-3" aria-hidden="true" tabindex="-1"></a>fgets<span class="op">(</span>s<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>s<span class="op">),</span> stdin<span class="op">);</span> <span class="co">// read a line from stdin</span></span></code></pre></div>
<p>In this case, the <code>sizeof()</code> operator gives us the total
size of the array in bytes, and since a <code>char</code> is a byte, it
conveniently gives us the total size of the array.</p>
<p>Of course, like I keep saying, the string returned from
<code>fgets()</code> probably has a newline at the end that you might
not want. You can write a short function to chop the newline off—in
fact, let’s just roll that into our own version of
<code>gets()</code></p>
<div class="sourceCode" id="cb1274"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1274-1"><a href="stdio.html#cb1274-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1274-2"><a href="stdio.html#cb1274-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span></span>
<span id="cb1274-3"><a href="stdio.html#cb1274-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1274-4"><a href="stdio.html#cb1274-4" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> <span class="op">*</span>ngets<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>s<span class="op">,</span> <span class="dt">int</span> size<span class="op">)</span></span>
<span id="cb1274-5"><a href="stdio.html#cb1274-5" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1274-6"><a href="stdio.html#cb1274-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> <span class="op">*</span>rv <span class="op">=</span> fgets<span class="op">(</span>s<span class="op">,</span> size<span class="op">,</span> stdin<span class="op">);</span></span>
<span id="cb1274-7"><a href="stdio.html#cb1274-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1274-8"><a href="stdio.html#cb1274-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>rv <span class="op">==</span> NULL<span class="op">)</span></span>
<span id="cb1274-9"><a href="stdio.html#cb1274-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> NULL<span class="op">;</span></span>
<span id="cb1274-10"><a href="stdio.html#cb1274-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1274-11"><a href="stdio.html#cb1274-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> <span class="op">*</span>p <span class="op">=</span> strchr<span class="op">(</span>s<span class="op">,</span> <span class="ch">'\n'</span><span class="op">);</span>  <span class="co">// Find a newline</span></span>
<span id="cb1274-12"><a href="stdio.html#cb1274-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1274-13"><a href="stdio.html#cb1274-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>p <span class="op">!=</span> NULL<span class="op">)</span>  <span class="co">// if there's a newline</span></span>
<span id="cb1274-14"><a href="stdio.html#cb1274-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>p <span class="op">=</span> <span class="ch">'\0'</span><span class="op">;</span>  <span class="co">// truncate the string there</span></span>
<span id="cb1274-15"><a href="stdio.html#cb1274-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1274-16"><a href="stdio.html#cb1274-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s<span class="op">;</span></span>
<span id="cb1274-17"><a href="stdio.html#cb1274-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>So, in summary, use <code>fgets()</code> to read a line of text from
the keyboard or a file, and don’t use <code>gets()</code>.</p>
<h3 class="unnumbered unlisted" id="return-value-147">Return Value</h3>
<p>Both <code>gets()</code> and <code>fgets()</code> return a pointer to
the string passed.</p>
<p>On error or end-of-file, the functions return <code>NULL</code>.</p>
<h3 class="unnumbered unlisted" id="example-150">Example</h3>
<div class="sourceCode" id="cb1275"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1275-1"><a href="stdio.html#cb1275-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1275-2"><a href="stdio.html#cb1275-2"></a></span>
<span id="cb1275-3"><a href="stdio.html#cb1275-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1275-4"><a href="stdio.html#cb1275-4"></a><span class="op">{</span></span>
<span id="cb1275-5"><a href="stdio.html#cb1275-5"></a>    <span class="dt">FILE</span> <span class="op">*</span>fp<span class="op">;</span></span>
<span id="cb1275-6"><a href="stdio.html#cb1275-6"></a>    <span class="dt">char</span> s<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb1275-7"><a href="stdio.html#cb1275-7"></a></span>
<span id="cb1275-8"><a href="stdio.html#cb1275-8"></a>    gets<span class="op">(</span>s<span class="op">);</span> <span class="co">// read from standard input (don't use this--use fgets()!)</span></span>
<span id="cb1275-9"><a href="stdio.html#cb1275-9"></a></span>
<span id="cb1275-10"><a href="stdio.html#cb1275-10"></a>    fgets<span class="op">(</span>s<span class="op">,</span> <span class="kw">sizeof</span> s<span class="op">,</span> stdin<span class="op">);</span> <span class="co">// read 100 bytes from standard input</span></span>
<span id="cb1275-11"><a href="stdio.html#cb1275-11"></a></span>
<span id="cb1275-12"><a href="stdio.html#cb1275-12"></a>    fp <span class="op">=</span> fopen<span class="op">(</span><span class="st">"spoon.txt"</span><span class="op">,</span> <span class="st">"r"</span><span class="op">);</span> <span class="co">// (you should error-check this)</span></span>
<span id="cb1275-13"><a href="stdio.html#cb1275-13"></a>    fgets<span class="op">(</span>s<span class="op">,</span> <span class="dv">100</span><span class="op">,</span> fp<span class="op">);</span> <span class="co">// read 100 bytes from the file datafile.dat</span></span>
<span id="cb1275-14"><a href="stdio.html#cb1275-14"></a>    fclose<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb1275-15"><a href="stdio.html#cb1275-15"></a></span>
<span id="cb1275-16"><a href="stdio.html#cb1275-16"></a>    fgets<span class="op">(</span>s<span class="op">,</span> <span class="dv">20</span><span class="op">,</span> stdin<span class="op">);</span> <span class="co">// read a maximum of 20 bytes from stdin</span></span>
<span id="cb1275-17"><a href="stdio.html#cb1275-17"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-141">See Also</h3>
<p><a href="stdio.html#man-getc"><code>getc()</code></a>, <a href="#man-getc"><code>fgetc()</code></a>, <a href="#man-getc"><code>getchar()</code></a>, <a href="#man-puts"><code>puts()</code></a>, <a href="#man-puts"><code>fputs()</code></a>, <a href="#man-ungetc"><code>ungetc()</code></a></p>
<hr>
<h2 data-number="61.16" id="man-putc"><span class="header-section-number">61.16</span> <code>putc()</code>,
<code>fputc()</code>, <code>putchar()</code></h2>
<p>Write a single character to the console or to a file</p>
<h3 class="unnumbered unlisted" id="synopsis-150">Synopsis</h3>
<div class="sourceCode" id="cb1276"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1276-1"><a href="stdio.html#cb1276-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1276-2"><a href="stdio.html#cb1276-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1276-3"><a href="stdio.html#cb1276-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> putc<span class="op">(</span><span class="dt">int</span> c<span class="op">,</span> <span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span>
<span id="cb1276-4"><a href="stdio.html#cb1276-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1276-5"><a href="stdio.html#cb1276-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fputc<span class="op">(</span><span class="dt">int</span> c<span class="op">,</span> <span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span>
<span id="cb1276-6"><a href="stdio.html#cb1276-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1276-7"><a href="stdio.html#cb1276-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> putchar<span class="op">(</span><span class="dt">int</span> c<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-150">Description</h3>
<p>All three functions output a single character, either to the console
or to a <code>FILE</code>.</p>
<p><code>putc()</code> takes a character argument, and outputs it to the
specified <code>FILE</code>. <code>fputc()</code> does exactly the same
thing, and differs from <code>putc()</code> in implementation only. Most
people use <code>fputc()</code>.</p>
<p><code>putchar()</code> writes the character to the console, and is
the same as calling <code>putc(c, stdout)</code>.</p>
<h3 class="unnumbered unlisted" id="return-value-148">Return Value</h3>
<p>All three functions return the character written on success, or
<code>EOF</code> on error.</p>
<h3 class="unnumbered unlisted" id="example-151">Example</h3>
<p>Print the alphabet:</p>
<div class="sourceCode" id="cb1277"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1277-1"><a href="stdio.html#cb1277-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1277-2"><a href="stdio.html#cb1277-2"></a></span>
<span id="cb1277-3"><a href="stdio.html#cb1277-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1277-4"><a href="stdio.html#cb1277-4"></a><span class="op">{</span></span>
<span id="cb1277-5"><a href="stdio.html#cb1277-5"></a>    <span class="dt">char</span> i<span class="op">;</span></span>
<span id="cb1277-6"><a href="stdio.html#cb1277-6"></a></span>
<span id="cb1277-7"><a href="stdio.html#cb1277-7"></a>    <span class="cf">for</span><span class="op">(</span>i <span class="op">=</span> <span class="ch">'A'</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="ch">'Z'</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb1277-8"><a href="stdio.html#cb1277-8"></a>        putchar<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb1277-9"><a href="stdio.html#cb1277-9"></a></span>
<span id="cb1277-10"><a href="stdio.html#cb1277-10"></a>    putchar<span class="op">(</span><span class="ch">'\n'</span><span class="op">);</span> <span class="co">// put a newline at the end to make it pretty</span></span>
<span id="cb1277-11"><a href="stdio.html#cb1277-11"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-142">See Also</h3>
<hr>
<h2 data-number="61.17" id="man-puts"><span class="header-section-number">61.17</span> <code>puts()</code>,
<code>fputs()</code></h2>
<p>Write a string to the console or to a file</p>
<h3 class="unnumbered unlisted" id="synopsis-151">Synopsis</h3>
<div class="sourceCode" id="cb1278"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1278-1"><a href="stdio.html#cb1278-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1278-2"><a href="stdio.html#cb1278-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1278-3"><a href="stdio.html#cb1278-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> puts<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>s<span class="op">);</span></span>
<span id="cb1278-4"><a href="stdio.html#cb1278-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1278-5"><a href="stdio.html#cb1278-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fputs<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>s<span class="op">,</span> <span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-151">Description</h3>
<p>Both these functions output a NUL-terminated string.
<code>puts()</code> outputs to the console, while <code>fputs()</code>
allows you to specify the file for output.</p>
<h3 class="unnumbered unlisted" id="return-value-149">Return Value</h3>
<p>Both functions return non-negative on success, or <code>EOF</code> on
error.</p>
<h3 class="unnumbered unlisted" id="example-152">Example</h3>
<p>Read strings from the console and save them in a file:</p>
<div class="sourceCode" id="cb1279"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1279-1"><a href="stdio.html#cb1279-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1279-2"><a href="stdio.html#cb1279-2"></a></span>
<span id="cb1279-3"><a href="stdio.html#cb1279-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1279-4"><a href="stdio.html#cb1279-4"></a><span class="op">{</span></span>
<span id="cb1279-5"><a href="stdio.html#cb1279-5"></a>    <span class="dt">FILE</span> <span class="op">*</span>fp<span class="op">;</span></span>
<span id="cb1279-6"><a href="stdio.html#cb1279-6"></a>    <span class="dt">char</span> s<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb1279-7"><a href="stdio.html#cb1279-7"></a></span>
<span id="cb1279-8"><a href="stdio.html#cb1279-8"></a>    fp <span class="op">=</span> fopen<span class="op">(</span><span class="st">"somefile.txt"</span><span class="op">,</span> <span class="st">"w"</span><span class="op">);</span> <span class="co">// error check this!</span></span>
<span id="cb1279-9"><a href="stdio.html#cb1279-9"></a></span>
<span id="cb1279-10"><a href="stdio.html#cb1279-10"></a>    <span class="cf">while</span><span class="op">(</span>fgets<span class="op">(</span>s<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>s<span class="op">),</span> stdin<span class="op">)</span> <span class="op">!=</span> NULL<span class="op">)</span> <span class="op">{</span> <span class="co">// read a string</span></span>
<span id="cb1279-11"><a href="stdio.html#cb1279-11"></a>        fputs<span class="op">(</span>s<span class="op">,</span> fp<span class="op">);</span>  <span class="co">// write it to the file we opened</span></span>
<span id="cb1279-12"><a href="stdio.html#cb1279-12"></a>    <span class="op">}</span></span>
<span id="cb1279-13"><a href="stdio.html#cb1279-13"></a></span>
<span id="cb1279-14"><a href="stdio.html#cb1279-14"></a>    fclose<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb1279-15"><a href="stdio.html#cb1279-15"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-143">See Also</h3>
<hr>
<h2 data-number="61.18" id="man-ungetc"><span class="header-section-number">61.18</span> <code>ungetc()</code></h2>
<p>Pushes a character back into the input stream</p>
<h3 class="unnumbered unlisted" id="synopsis-152">Synopsis</h3>
<div class="sourceCode" id="cb1280"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1280-1"><a href="stdio.html#cb1280-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1280-2"><a href="stdio.html#cb1280-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1280-3"><a href="stdio.html#cb1280-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ungetc<span class="op">(</span><span class="dt">int</span> c<span class="op">,</span> <span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-152">Description</h3>
<p>You know how <code>getc()</code> reads the next character from a file
stream? Well, this is the opposite of that—it pushes a character back
into the file stream so that it will show up again on the very next read
from the stream, as if you’d never gotten it from <code>getc()</code> in
the first place.</p>
<p>Why, in the name of all that is holy would you want to do that?
Perhaps you have a stream of data that you’re reading a character at a
time, and you won’t know to stop reading until you get a certain
character, but you want to be able to read that character again later.
You can read the character, see that it’s what you’re supposed to stop
on, and then <code>ungetc()</code> it so it’ll show up on the next
read.</p>
<p>Yeah, that doesn’t happen very often, but there we are.</p>
<p>Here’s the catch: the standard only guarantees that you’ll be able to
push back <em>one character</em>. Some implementations might allow you
to push back more, but there’s really no way to tell and still be
portable.</p>
<h3 class="unnumbered unlisted" id="return-value-150">Return Value</h3>
<p>On success, <code>ungetc()</code> returns the character you passed to
it. On failure, it returns <code>EOF</code>.</p>
<h3 class="unnumbered unlisted" id="example-153">Example</h3>
<p>This example reads a piece of punctuation, then everything after it
up to the next piece of punctuation. It returns the leading punctuation,
and stores the rest in a string.</p>
<div class="sourceCode" id="cb1281"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1281-1"><a href="stdio.html#cb1281-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1281-2"><a href="stdio.html#cb1281-2"></a><span class="pp">#include </span><span class="im">&lt;ctype.h&gt;</span></span>
<span id="cb1281-3"><a href="stdio.html#cb1281-3"></a></span>
<span id="cb1281-4"><a href="stdio.html#cb1281-4"></a><span class="dt">int</span> read_punctstring<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>fp<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>s<span class="op">)</span></span>
<span id="cb1281-5"><a href="stdio.html#cb1281-5"></a><span class="op">{</span></span>
<span id="cb1281-6"><a href="stdio.html#cb1281-6"></a>    <span class="dt">int</span> origpunct<span class="op">,</span> c<span class="op">;</span></span>
<span id="cb1281-7"><a href="stdio.html#cb1281-7"></a>    </span>
<span id="cb1281-8"><a href="stdio.html#cb1281-8"></a>    origpunct <span class="op">=</span> fgetc<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb1281-9"><a href="stdio.html#cb1281-9"></a></span>
<span id="cb1281-10"><a href="stdio.html#cb1281-10"></a>    <span class="cf">if</span> <span class="op">(</span>origpunct <span class="op">==</span> EOF<span class="op">)</span>  <span class="co">// return EOF on end-of-file</span></span>
<span id="cb1281-11"><a href="stdio.html#cb1281-11"></a>        <span class="cf">return</span> EOF<span class="op">;</span></span>
<span id="cb1281-12"><a href="stdio.html#cb1281-12"></a></span>
<span id="cb1281-13"><a href="stdio.html#cb1281-13"></a>    <span class="cf">while</span> <span class="op">(</span>c <span class="op">=</span> fgetc<span class="op">(</span>fp<span class="op">),</span> <span class="op">!</span>ispunct<span class="op">(</span>c<span class="op">)</span> <span class="op">&amp;&amp;</span> c <span class="op">!=</span> EOF<span class="op">)</span></span>
<span id="cb1281-14"><a href="stdio.html#cb1281-14"></a>        <span class="op">*</span>s<span class="op">++</span> <span class="op">=</span> c<span class="op">;</span>  <span class="co">// save it in the string</span></span>
<span id="cb1281-15"><a href="stdio.html#cb1281-15"></a></span>
<span id="cb1281-16"><a href="stdio.html#cb1281-16"></a>    <span class="op">*</span>s <span class="op">=</span> <span class="ch">'\0'</span><span class="op">;</span> <span class="co">// nul-terminate the string</span></span>
<span id="cb1281-17"><a href="stdio.html#cb1281-17"></a></span>
<span id="cb1281-18"><a href="stdio.html#cb1281-18"></a>    <span class="co">// if we read punctuation last, ungetc it so we can fgetc it next</span></span>
<span id="cb1281-19"><a href="stdio.html#cb1281-19"></a>    <span class="co">// time:</span></span>
<span id="cb1281-20"><a href="stdio.html#cb1281-20"></a>    <span class="cf">if</span> <span class="op">(</span>ispunct<span class="op">(</span>c<span class="op">))</span></span>
<span id="cb1281-21"><a href="stdio.html#cb1281-21"></a>        ungetc<span class="op">(</span>c<span class="op">,</span> fp<span class="op">);</span></span>
<span id="cb1281-22"><a href="stdio.html#cb1281-22"></a></span>
<span id="cb1281-23"><a href="stdio.html#cb1281-23"></a>    <span class="cf">return</span> origpunct<span class="op">;</span></span>
<span id="cb1281-24"><a href="stdio.html#cb1281-24"></a><span class="op">}</span></span>
<span id="cb1281-25"><a href="stdio.html#cb1281-25"></a></span>
<span id="cb1281-26"><a href="stdio.html#cb1281-26"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1281-27"><a href="stdio.html#cb1281-27"></a><span class="op">{</span></span>
<span id="cb1281-28"><a href="stdio.html#cb1281-28"></a>    <span class="dt">char</span> s<span class="op">[</span><span class="dv">128</span><span class="op">];</span></span>
<span id="cb1281-29"><a href="stdio.html#cb1281-29"></a>    <span class="dt">char</span> c<span class="op">;</span></span>
<span id="cb1281-30"><a href="stdio.html#cb1281-30"></a></span>
<span id="cb1281-31"><a href="stdio.html#cb1281-31"></a>    <span class="cf">while</span><span class="op">((</span>c <span class="op">=</span> read_punctstring<span class="op">(</span>stdin<span class="op">,</span> s<span class="op">))</span> <span class="op">!=</span> EOF<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1281-32"><a href="stdio.html#cb1281-32"></a>        printf<span class="op">(</span><span class="st">"%c: %s</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> c<span class="op">,</span> s<span class="op">);</span></span>
<span id="cb1281-33"><a href="stdio.html#cb1281-33"></a>    <span class="op">}</span></span>
<span id="cb1281-34"><a href="stdio.html#cb1281-34"></a><span class="op">}</span></span></code></pre></div>
<p>Sample Input:</p>
<div class="sourceCode" id="cb1282"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb1282-1"><a href="stdio.html#cb1282-1" aria-hidden="true" tabindex="-1"></a>!foo#bar*baz</span></code></pre></div>
<p>Sample output:</p>
<div class="sourceCode" id="cb1283"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb1283-1"><a href="stdio.html#cb1283-1" aria-hidden="true" tabindex="-1"></a>!: foo</span>
<span id="cb1283-2"><a href="stdio.html#cb1283-2" aria-hidden="true" tabindex="-1"></a>#: bar</span>
<span id="cb1283-3"><a href="stdio.html#cb1283-3" aria-hidden="true" tabindex="-1"></a>*: baz</span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-144">See Also</h3>
<p><a href="stdio.html#man-getc"><code>fgetc()</code></a></p>
<hr>
<h2 data-number="61.19" id="man-fread"><span class="header-section-number">61.19</span> <code>fread()</code></h2>
<p>Read binary data from a file</p>
<h3 class="unnumbered unlisted" id="synopsis-153">Synopsis</h3>
<div class="sourceCode" id="cb1284"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1284-1"><a href="stdio.html#cb1284-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1284-2"><a href="stdio.html#cb1284-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1284-3"><a href="stdio.html#cb1284-3" aria-hidden="true" tabindex="-1"></a><span class="dt">size_t</span> fread<span class="op">(</span><span class="dt">void</span> <span class="op">*</span>p<span class="op">,</span> <span class="dt">size_t</span> size<span class="op">,</span> <span class="dt">size_t</span> nmemb<span class="op">,</span> <span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-153">Description</h3>
<p>You might remember that you can call <a href="#man-fopen"><code>fopen()</code></a> with the “<code>b</code>”
flag in the open mode string to open the file in “binary” mode. Files
open in not-binary (ASCII or text mode) can be read using standard
character-oriented calls like <a href="#man-getc"><code>fgetc()</code></a> or <a href="#man-gets"><code>fgets()</code></a>. Files open in binary mode are
typically read using the <code>fread()</code> function.</p>
<p>All this function does is says, “Hey, read this many things where
each thing is a certain number of bytes, and store the whole mess of
them in memory starting at this pointer.”</p>
<p>This can be very useful, believe me, when you want to do something
like store 20 <code>int</code>s in a file.</p>
<p>But wait—can’t you use <a href="#man-printf"><code>fprintf()</code></a> with the “<code>%d</code>”
format specifier to save the <code>int</code>s to a text file and store
them that way? Yes, sure. That has the advantage that a human can open
the file and read the numbers. It has the disadvantage that it’s slower
to convert the numbers from <code>int</code>s to text and that the
numbers are likely to take more space in the file. (Remember, an
<code>int</code> is likely 4 bytes, but the string “12345678” is 8
bytes.)</p>
<p>So storing the binary data can certainly be more compact and faster
to read.</p>
<h3 class="unnumbered unlisted" id="return-value-151">Return Value</h3>
<p>This function returns the number of items successfully read. If all
requested items are read, the return value will be equal to that of the
parameter <code>nmemb</code>. If EOF occurs, the return value will be
zero.</p>
<p>To make you confused, it will also return zero if there’s an error.
You can use the functions <a href="stdio.html#man-feof"><code>feof()</code></a> or
<a href="stdio.html#man-feof"><code>ferror()</code></a> to tell which one really
happened.</p>
<h3 class="unnumbered unlisted" id="example-154">Example</h3>
<p>Read 10 numbers from a file and store them in an array:</p>
<div class="sourceCode" id="cb1285"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1285-1"><a href="stdio.html#cb1285-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1285-2"><a href="stdio.html#cb1285-2"></a></span>
<span id="cb1285-3"><a href="stdio.html#cb1285-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1285-4"><a href="stdio.html#cb1285-4"></a><span class="op">{</span></span>
<span id="cb1285-5"><a href="stdio.html#cb1285-5"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb1285-6"><a href="stdio.html#cb1285-6"></a>    <span class="dt">int</span> n<span class="op">[</span><span class="dv">10</span><span class="op">]</span></span>
<span id="cb1285-7"><a href="stdio.html#cb1285-7"></a>    <span class="dt">FILE</span> <span class="op">*</span>fp<span class="op">;</span></span>
<span id="cb1285-8"><a href="stdio.html#cb1285-8"></a></span>
<span id="cb1285-9"><a href="stdio.html#cb1285-9"></a>    fp <span class="op">=</span> fopen<span class="op">(</span><span class="st">"numbers.dat"</span><span class="op">,</span> <span class="st">"rb"</span><span class="op">);</span></span>
<span id="cb1285-10"><a href="stdio.html#cb1285-10"></a>    fread<span class="op">(</span>n<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">int</span><span class="op">),</span> <span class="dv">10</span><span class="op">,</span> fp<span class="op">);</span>  <span class="co">// read 10 ints</span></span>
<span id="cb1285-11"><a href="stdio.html#cb1285-11"></a>    fclose<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb1285-12"><a href="stdio.html#cb1285-12"></a></span>
<span id="cb1285-13"><a href="stdio.html#cb1285-13"></a>    <span class="co">// print them out:</span></span>
<span id="cb1285-14"><a href="stdio.html#cb1285-14"></a>    <span class="cf">for</span><span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">10</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb1285-15"><a href="stdio.html#cb1285-15"></a>        printf<span class="op">(</span><span class="st">"n[%d] == %d</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> i<span class="op">,</span> n<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb1285-16"><a href="stdio.html#cb1285-16"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-145">See Also</h3>
<p><a href="stdio.html#man-fopen"><code>fopen()</code></a>, <a href="#man-fwrite"><code>fwrite()</code></a>, <a href="#man-feof"><code>feof()</code></a>, <a href="#man-feof"><code>ferror()</code></a></p>
<hr>
<h2 data-number="61.20" id="man-fwrite"><span class="header-section-number">61.20</span> <code>fwrite()</code></h2>
<p>Write binary data to a file</p>
<h3 class="unnumbered unlisted" id="synopsis-154">Synopsis</h3>
<div class="sourceCode" id="cb1286"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1286-1"><a href="stdio.html#cb1286-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1286-2"><a href="stdio.html#cb1286-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1286-3"><a href="stdio.html#cb1286-3" aria-hidden="true" tabindex="-1"></a><span class="dt">size_t</span> fwrite<span class="op">(</span><span class="dt">const</span> <span class="dt">void</span> <span class="op">*</span>p<span class="op">,</span> <span class="dt">size_t</span> size<span class="op">,</span> <span class="dt">size_t</span> nmemb<span class="op">,</span> <span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-154">Description</h3>
<p>This is the counterpart to the <a href="#man-fread"><code>fread()</code></a> function. It writes blocks of
binary data to disk. For a description of what this means, see the entry
for <a href="stdio.html#man-fread"><code>fread()</code></a>.</p>
<h3 class="unnumbered unlisted" id="return-value-152">Return Value</h3>
<p><code>fwrite()</code> returns the number of items successfully
written, which should hopefully be <code>nmemb</code> that you passed
in. It’ll return zero on error.</p>
<h3 class="unnumbered unlisted" id="example-155">Example</h3>
<p>Save 10 random numbers to a file:</p>
<div class="sourceCode" id="cb1287"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1287-1"><a href="stdio.html#cb1287-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1287-2"><a href="stdio.html#cb1287-2"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb1287-3"><a href="stdio.html#cb1287-3"></a></span>
<span id="cb1287-4"><a href="stdio.html#cb1287-4"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1287-5"><a href="stdio.html#cb1287-5"></a><span class="op">{</span></span>
<span id="cb1287-6"><a href="stdio.html#cb1287-6"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb1287-7"><a href="stdio.html#cb1287-7"></a>    <span class="dt">int</span> n<span class="op">[</span><span class="dv">10</span><span class="op">];</span></span>
<span id="cb1287-8"><a href="stdio.html#cb1287-8"></a>    <span class="dt">FILE</span> <span class="op">*</span>fp<span class="op">;</span></span>
<span id="cb1287-9"><a href="stdio.html#cb1287-9"></a></span>
<span id="cb1287-10"><a href="stdio.html#cb1287-10"></a>    <span class="co">// populate the array with random numbers:</span></span>
<span id="cb1287-11"><a href="stdio.html#cb1287-11"></a>    <span class="cf">for</span><span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">10</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1287-12"><a href="stdio.html#cb1287-12"></a>        n<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> rand<span class="op">();</span></span>
<span id="cb1287-13"><a href="stdio.html#cb1287-13"></a>        printf<span class="op">(</span><span class="st">"n[%d] = %d</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> i<span class="op">,</span> n<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb1287-14"><a href="stdio.html#cb1287-14"></a>    <span class="op">}</span></span>
<span id="cb1287-15"><a href="stdio.html#cb1287-15"></a></span>
<span id="cb1287-16"><a href="stdio.html#cb1287-16"></a>    <span class="co">// save the random numbers (10 ints) to the file</span></span>
<span id="cb1287-17"><a href="stdio.html#cb1287-17"></a>    fp <span class="op">=</span> fopen<span class="op">(</span><span class="st">"numbers.dat"</span><span class="op">,</span> <span class="st">"wb"</span><span class="op">);</span></span>
<span id="cb1287-18"><a href="stdio.html#cb1287-18"></a>    fwrite<span class="op">(</span>n<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">int</span><span class="op">),</span> <span class="dv">10</span><span class="op">,</span> fp<span class="op">);</span> <span class="co">// write 10 ints</span></span>
<span id="cb1287-19"><a href="stdio.html#cb1287-19"></a>    fclose<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb1287-20"><a href="stdio.html#cb1287-20"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-146">See Also</h3>
<p><a href="stdio.html#man-fopen"><code>fopen()</code></a>, <a href="#man-fread"><code>fread()</code></a></p>
<hr>
<h2 data-number="61.21" id="man-fgetpos"><span class="header-section-number">61.21</span> <code>fgetpos()</code>,
<code>fsetpos()</code></h2>
<p>Get the current position in a file, or set the current position in a
file. Just like <code>ftell()</code> and <code>fseek()</code> for most
systems</p>
<h3 class="unnumbered unlisted" id="synopsis-155">Synopsis</h3>
<div class="sourceCode" id="cb1288"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1288-1"><a href="stdio.html#cb1288-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1288-2"><a href="stdio.html#cb1288-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1288-3"><a href="stdio.html#cb1288-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fgetpos<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">,</span> <span class="dt">fpos_t</span> <span class="op">*</span>pos<span class="op">);</span></span>
<span id="cb1288-4"><a href="stdio.html#cb1288-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1288-5"><a href="stdio.html#cb1288-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fsetpos<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">,</span> <span class="dt">fpos_t</span> <span class="op">*</span>pos<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-155">Description</h3>
<p>These functions are just like <code>ftell()</code> and
<code>fseek()</code>, except instead of counting in bytes, they use an
<em>opaque</em> data structure to hold positional information about the
file. (Opaque, in this case, means you’re not supposed to know what the
data type is made up of.)</p>
<p>On virtually every system (and certainly every system that I know
of), people don’t use these functions, using <code>ftell()</code> and
<code>fseek()</code> instead. These functions exist just in case your
system can’t remember file positions as a simple byte offset.</p>
<p>Since the <code>pos</code> variable is opaque, you have to assign to
it using the <code>fgetpos()</code> call itself. Then you save the value
for later and use it to reset the position using
<code>fsetpos()</code>.</p>
<h3 class="unnumbered unlisted" id="return-value-153">Return Value</h3>
<p>Both functions return zero on success, and <code>-1</code> on
error.</p>
<h3 class="unnumbered unlisted" id="example-156">Example</h3>
<div class="sourceCode" id="cb1289"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1289-1"><a href="stdio.html#cb1289-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1289-2"><a href="stdio.html#cb1289-2"></a></span>
<span id="cb1289-3"><a href="stdio.html#cb1289-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1289-4"><a href="stdio.html#cb1289-4"></a><span class="op">{</span></span>
<span id="cb1289-5"><a href="stdio.html#cb1289-5"></a>    <span class="dt">char</span> s<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb1289-6"><a href="stdio.html#cb1289-6"></a>    <span class="dt">fpos_t</span> pos<span class="op">;</span></span>
<span id="cb1289-7"><a href="stdio.html#cb1289-7"></a>    <span class="dt">FILE</span> <span class="op">*</span>fp<span class="op">;</span></span>
<span id="cb1289-8"><a href="stdio.html#cb1289-8"></a></span>
<span id="cb1289-9"><a href="stdio.html#cb1289-9"></a>    fp <span class="op">=</span> fopen<span class="op">(</span><span class="st">"spoon.txt"</span><span class="op">,</span> <span class="st">"r"</span><span class="op">);</span></span>
<span id="cb1289-10"><a href="stdio.html#cb1289-10"></a></span>
<span id="cb1289-11"><a href="stdio.html#cb1289-11"></a>    fgets<span class="op">(</span>s<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>s<span class="op">),</span> fp<span class="op">);</span> <span class="co">// read a line from the file</span></span>
<span id="cb1289-12"><a href="stdio.html#cb1289-12"></a>    printf<span class="op">(</span><span class="st">"%s"</span><span class="op">,</span> s<span class="op">);</span></span>
<span id="cb1289-13"><a href="stdio.html#cb1289-13"></a></span>
<span id="cb1289-14"><a href="stdio.html#cb1289-14"></a>    fgetpos<span class="op">(</span>fp<span class="op">,</span> <span class="op">&amp;</span>pos<span class="op">);</span>   <span class="co">// save the position after the read</span></span>
<span id="cb1289-15"><a href="stdio.html#cb1289-15"></a></span>
<span id="cb1289-16"><a href="stdio.html#cb1289-16"></a>    fgets<span class="op">(</span>s<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>s<span class="op">),</span> fp<span class="op">);</span> <span class="co">// read another line from the file</span></span>
<span id="cb1289-17"><a href="stdio.html#cb1289-17"></a>    printf<span class="op">(</span><span class="st">"%s"</span><span class="op">,</span> s<span class="op">);</span></span>
<span id="cb1289-18"><a href="stdio.html#cb1289-18"></a></span>
<span id="cb1289-19"><a href="stdio.html#cb1289-19"></a>    fsetpos<span class="op">(</span>fp<span class="op">,</span> <span class="op">&amp;</span>pos<span class="op">);</span>   <span class="co">// now restore the position to where we saved</span></span>
<span id="cb1289-20"><a href="stdio.html#cb1289-20"></a></span>
<span id="cb1289-21"><a href="stdio.html#cb1289-21"></a>    fgets<span class="op">(</span>s<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>s<span class="op">),</span> fp<span class="op">);</span> <span class="co">// read the earlier line again</span></span>
<span id="cb1289-22"><a href="stdio.html#cb1289-22"></a>    printf<span class="op">(</span><span class="st">"%s"</span><span class="op">,</span> s<span class="op">);</span></span>
<span id="cb1289-23"><a href="stdio.html#cb1289-23"></a></span>
<span id="cb1289-24"><a href="stdio.html#cb1289-24"></a>    fclose<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb1289-25"><a href="stdio.html#cb1289-25"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-147">See Also</h3>
<p><a href="stdio.html#man-fseek"><code>fseek()</code></a>, <a href="#man-ftell"><code>ftell()</code></a>, <a href="#man-fseek"><code>rewind()</code></a></p>
<hr>
<h2 data-number="61.22" id="man-fseek"><span class="header-section-number">61.22</span> <code>fseek()</code>,
<code>rewind()</code></h2>
<p>Position the file pointer in anticipition of the next read or
write</p>
<h3 class="unnumbered unlisted" id="synopsis-156">Synopsis</h3>
<div class="sourceCode" id="cb1290"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1290-1"><a href="stdio.html#cb1290-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1290-2"><a href="stdio.html#cb1290-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1290-3"><a href="stdio.html#cb1290-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fseek<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">,</span> <span class="dt">long</span> offset<span class="op">,</span> <span class="dt">int</span> whence<span class="op">);</span></span>
<span id="cb1290-4"><a href="stdio.html#cb1290-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1290-5"><a href="stdio.html#cb1290-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> rewind<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-156">Description</h3>
<p>When doing reads and writes to a file, the OS keeps track of where
you are in the file using a counter generically known as the file
pointer. You can reposition the file pointer to a different point in the
file using the <code>fseek()</code> call. Think of it as a way to
randomly access you file.</p>
<p>The first argument is the file in question, obviously.
<code>offset</code> argument is the position that you want to seek to,
and <code>whence</code> is what that offset is relative to.</p>
<p>Of course, you probably like to think of the offset as being from the
beginning of the file. I mean, “Seek to position 3490, that should be
3490 bytes from the beginning of the file.” Well, it <em>can</em> be,
but it doesn’t have to be. Imagine the power you’re wielding here. Try
to command your enthusiasm.</p>
<p>You can set the value of <code>whence</code> to one of three
things:</p>
<table>
<colgroup>
<col style="width: 15%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="header">
<th><code>whence</code></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>SEEK_SET</code></td>
<td><code>offset</code> is relative to the beginning of the file. This
is probably what you had in mind anyway, and is the most commonly used
value for <code>whence</code>.</td>
</tr>
<tr class="even">
<td><code>SEEK_CUR</code></td>
<td><code>offset</code> is relative to the current file pointer
position. So, in effect, you can say, “Move to my current position plus
30 bytes,” or, “move to my current position minus 20 bytes.”</td>
</tr>
<tr class="odd">
<td><code>SEEK_END</code></td>
<td><code>offset</code> is relative to the end of the file. Just like
<code>SEEK_SET</code> except from the other end of the file. Be sure to
use negative values for <code>offset</code> if you want to back up from
the end of the file, instead of going past the end into oblivion.</td>
</tr>
</tbody>
</table>
<p>Speaking of seeking off the end of the file, can you do it? Sure
thing. In fact, you can seek way off the end and then write a character;
the file will be expanded to a size big enough to hold a bunch of zeros
way out to that character.</p>
<p>Now that the complicated function is out of the way, what’s this
<code>rewind()</code> that I briefly mentioned? It repositions the file
pointer at the beginning of the file:</p>
<div class="sourceCode" id="cb1291"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1291-1"><a href="stdio.html#cb1291-1" aria-hidden="true" tabindex="-1"></a>fseek<span class="op">(</span>fp<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> SEEK_SET<span class="op">);</span> <span class="co">// same as rewind()</span></span>
<span id="cb1291-2"><a href="stdio.html#cb1291-2" aria-hidden="true" tabindex="-1"></a>rewind<span class="op">(</span>fp<span class="op">);</span>             <span class="co">// same as fseek(fp, 0, SEEK_SET)</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="return-value-154">Return Value</h3>
<p>For <code>fseek()</code>, on success zero is returned;
<code>-1</code> is returned on failure.</p>
<p>The call to <code>rewind()</code> never fails.</p>
<h3 class="unnumbered unlisted" id="example-157">Example</h3>
<div class="sourceCode" id="cb1292"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1292-1"><a href="stdio.html#cb1292-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1292-2"><a href="stdio.html#cb1292-2"></a></span>
<span id="cb1292-3"><a href="stdio.html#cb1292-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1292-4"><a href="stdio.html#cb1292-4"></a><span class="op">{</span></span>
<span id="cb1292-5"><a href="stdio.html#cb1292-5"></a>    <span class="dt">FILE</span> <span class="op">*</span>fp<span class="op">;</span></span>
<span id="cb1292-6"><a href="stdio.html#cb1292-6"></a></span>
<span id="cb1292-7"><a href="stdio.html#cb1292-7"></a>    fp <span class="op">=</span> fopen<span class="op">(</span><span class="st">"spoon.txt"</span><span class="op">,</span> <span class="st">"r"</span><span class="op">);</span></span>
<span id="cb1292-8"><a href="stdio.html#cb1292-8"></a></span>
<span id="cb1292-9"><a href="stdio.html#cb1292-9"></a>    fseek<span class="op">(</span>fp<span class="op">,</span> <span class="dv">100</span><span class="op">,</span> SEEK_SET<span class="op">);</span> <span class="co">// seek to the 100th byte of the file</span></span>
<span id="cb1292-10"><a href="stdio.html#cb1292-10"></a>    printf<span class="op">(</span><span class="st">"100: %c</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> fgetc<span class="op">(</span>fp<span class="op">));</span></span>
<span id="cb1292-11"><a href="stdio.html#cb1292-11"></a></span>
<span id="cb1292-12"><a href="stdio.html#cb1292-12"></a>    fseek<span class="op">(</span>fp<span class="op">,</span> <span class="op">-</span><span class="dv">31</span><span class="op">,</span> SEEK_CUR<span class="op">);</span> <span class="co">// seek backward 30 bytes from the current pos</span></span>
<span id="cb1292-13"><a href="stdio.html#cb1292-13"></a>    printf<span class="op">(</span><span class="st">"31 back: %c</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> fgetc<span class="op">(</span>fp<span class="op">));</span></span>
<span id="cb1292-14"><a href="stdio.html#cb1292-14"></a></span>
<span id="cb1292-15"><a href="stdio.html#cb1292-15"></a>    fseek<span class="op">(</span>fp<span class="op">,</span> <span class="op">-</span><span class="dv">12</span><span class="op">,</span> SEEK_END<span class="op">);</span> <span class="co">// seek to the 10th byte before the end of file</span></span>
<span id="cb1292-16"><a href="stdio.html#cb1292-16"></a>    printf<span class="op">(</span><span class="st">"12 from end: %c</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> fgetc<span class="op">(</span>fp<span class="op">));</span></span>
<span id="cb1292-17"><a href="stdio.html#cb1292-17"></a></span>
<span id="cb1292-18"><a href="stdio.html#cb1292-18"></a>    fseek<span class="op">(</span>fp<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> SEEK_SET<span class="op">);</span>   <span class="co">// seek to the beginning of the file</span></span>
<span id="cb1292-19"><a href="stdio.html#cb1292-19"></a>    rewind<span class="op">(</span>fp<span class="op">);</span>               <span class="co">// seek to the beginning of the file, too</span></span>
<span id="cb1292-20"><a href="stdio.html#cb1292-20"></a>    printf<span class="op">(</span><span class="st">"Beginning: %c</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> fgetc<span class="op">(</span>fp<span class="op">));</span></span>
<span id="cb1292-21"><a href="stdio.html#cb1292-21"></a></span>
<span id="cb1292-22"><a href="stdio.html#cb1292-22"></a>    fclose<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb1292-23"><a href="stdio.html#cb1292-23"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-148">See Also</h3>
<p><a href="stdio.html#man-ftell"><code>ftell()</code></a>, <a href="#man-fgetpos"><code>fgetpos()</code></a>, <a href="#man-fgetpos"><code>fsetpos()</code></a></p>
<hr>
<h2 data-number="61.23" id="man-ftell"><span class="header-section-number">61.23</span> <code>ftell()</code></h2>
<p>Tells you where a particular file is about to read from or write
to</p>
<h3 class="unnumbered unlisted" id="synopsis-157">Synopsis</h3>
<div class="sourceCode" id="cb1293"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1293-1"><a href="stdio.html#cb1293-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1293-2"><a href="stdio.html#cb1293-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1293-3"><a href="stdio.html#cb1293-3" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> ftell<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-157">Description</h3>
<p>This function is the opposite of <a href="#man-fseek"><code>fseek()</code></a>. It tells you where in the
file the next file operation will occur relative to the beginning of the
file.</p>
<p>It’s useful if you want to remember where you are in the file,
<code>fseek()</code> somewhere else, and then come back later. You can
take the return value from <code>ftell()</code> and feed it back into
<code>fseek()</code> (with <code>whence</code> parameter set to
<code>SEEK_SET</code>) when you want to return to your previous
position.</p>
<h3 class="unnumbered unlisted" id="return-value-155">Return Value</h3>
<p>Returns the current offset in the file, or <code>-1</code> on
error.</p>
<h3 class="unnumbered unlisted" id="example-158">Example</h3>
<div class="sourceCode" id="cb1294"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1294-1"><a href="stdio.html#cb1294-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1294-2"><a href="stdio.html#cb1294-2"></a></span>
<span id="cb1294-3"><a href="stdio.html#cb1294-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1294-4"><a href="stdio.html#cb1294-4"></a><span class="op">{</span></span>
<span id="cb1294-5"><a href="stdio.html#cb1294-5"></a>    <span class="dt">char</span> c<span class="op">[</span><span class="dv">6</span><span class="op">];</span></span>
<span id="cb1294-6"><a href="stdio.html#cb1294-6"></a>    <span class="dt">FILE</span> <span class="op">*</span>fp<span class="op">;</span></span>
<span id="cb1294-7"><a href="stdio.html#cb1294-7"></a></span>
<span id="cb1294-8"><a href="stdio.html#cb1294-8"></a>    fp <span class="op">=</span> fopen<span class="op">(</span><span class="st">"spoon.txt"</span><span class="op">,</span> <span class="st">"r"</span><span class="op">);</span></span>
<span id="cb1294-9"><a href="stdio.html#cb1294-9"></a></span>
<span id="cb1294-10"><a href="stdio.html#cb1294-10"></a>    <span class="dt">long</span> pos<span class="op">;</span></span>
<span id="cb1294-11"><a href="stdio.html#cb1294-11"></a></span>
<span id="cb1294-12"><a href="stdio.html#cb1294-12"></a>    <span class="co">// seek ahead 10 bytes:</span></span>
<span id="cb1294-13"><a href="stdio.html#cb1294-13"></a>    fseek<span class="op">(</span>fp<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> SEEK_SET<span class="op">);</span></span>
<span id="cb1294-14"><a href="stdio.html#cb1294-14"></a></span>
<span id="cb1294-15"><a href="stdio.html#cb1294-15"></a>    <span class="co">// store the current position in variable "pos":</span></span>
<span id="cb1294-16"><a href="stdio.html#cb1294-16"></a>    pos <span class="op">=</span> ftell<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb1294-17"><a href="stdio.html#cb1294-17"></a></span>
<span id="cb1294-18"><a href="stdio.html#cb1294-18"></a>    <span class="co">// Read some bytes</span></span>
<span id="cb1294-19"><a href="stdio.html#cb1294-19"></a>    fread<span class="op">(</span>c<span class="op">,</span> <span class="kw">sizeof</span> c  <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> fp<span class="op">);</span></span>
<span id="cb1294-20"><a href="stdio.html#cb1294-20"></a>    c<span class="op">[</span><span class="dv">5</span><span class="op">]</span> <span class="op">=</span> <span class="ch">'\0'</span><span class="op">;</span></span>
<span id="cb1294-21"><a href="stdio.html#cb1294-21"></a>    printf<span class="op">(</span><span class="st">"Read: </span><span class="sc">\"</span><span class="st">%s</span><span class="sc">\"\n</span><span class="st">"</span><span class="op">,</span> c<span class="op">);</span></span>
<span id="cb1294-22"><a href="stdio.html#cb1294-22"></a></span>
<span id="cb1294-23"><a href="stdio.html#cb1294-23"></a>    <span class="co">// and return to the starting position, stored in "pos":</span></span>
<span id="cb1294-24"><a href="stdio.html#cb1294-24"></a>    fseek<span class="op">(</span>fp<span class="op">,</span> pos<span class="op">,</span> SEEK_SET<span class="op">);</span></span>
<span id="cb1294-25"><a href="stdio.html#cb1294-25"></a></span>
<span id="cb1294-26"><a href="stdio.html#cb1294-26"></a>    <span class="co">// Read the same bytes again</span></span>
<span id="cb1294-27"><a href="stdio.html#cb1294-27"></a>    fread<span class="op">(</span>c<span class="op">,</span> <span class="kw">sizeof</span> c  <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> fp<span class="op">);</span></span>
<span id="cb1294-28"><a href="stdio.html#cb1294-28"></a>    c<span class="op">[</span><span class="dv">5</span><span class="op">]</span> <span class="op">=</span> <span class="ch">'\0'</span><span class="op">;</span></span>
<span id="cb1294-29"><a href="stdio.html#cb1294-29"></a>    printf<span class="op">(</span><span class="st">"Read: </span><span class="sc">\"</span><span class="st">%s</span><span class="sc">\"\n</span><span class="st">"</span><span class="op">,</span> c<span class="op">);</span></span>
<span id="cb1294-30"><a href="stdio.html#cb1294-30"></a></span>
<span id="cb1294-31"><a href="stdio.html#cb1294-31"></a>    fclose<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb1294-32"><a href="stdio.html#cb1294-32"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-149">See Also</h3>
<p><a href="stdio.html#man-fseek"><code>fseek()</code></a>, <a href="#man-fseek"><code>rewind()</code></a>, <a href="#man-fgetpos"><code>fgetpos()</code></a>, <a href="#man-fgetpos"><code>fsetpos()</code></a></p>
<hr>
<h2 data-number="61.24" id="man-feof"><span class="header-section-number">61.24</span> <code>feof()</code>,
<code>ferror()</code>, <code>clearerr()</code></h2>
<p>Determine if a file has reached end-of-file or if an error has
occurred</p>
<h3 class="unnumbered unlisted" id="synopsis-158">Synopsis</h3>
<div class="sourceCode" id="cb1295"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1295-1"><a href="stdio.html#cb1295-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1295-2"><a href="stdio.html#cb1295-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1295-3"><a href="stdio.html#cb1295-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> feof<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span>
<span id="cb1295-4"><a href="stdio.html#cb1295-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1295-5"><a href="stdio.html#cb1295-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ferror<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span>
<span id="cb1295-6"><a href="stdio.html#cb1295-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1295-7"><a href="stdio.html#cb1295-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> clearerr<span class="op">(</span><span class="dt">FILE</span> <span class="op">*</span>stream<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-158">Description</h3>
<p>Each <code>FILE*</code> that you use to read and write data from and
to a file contains flags that the system sets when certain events occur.
If you get an error, it sets the error flag; if you reach the end of the
file during a read, it sets the EOF flag. Pretty simple really.</p>
<p>The functions <code>feof()</code> and <code>ferror()</code> give you
a simple way to test these flags: they’ll return non-zero (true) if
they’re set.</p>
<p>Once the flags are set for a particular stream, they stay that way
until you call <code>clearerr()</code> to clear them.</p>
<h3 class="unnumbered unlisted" id="return-value-156">Return Value</h3>
<p><code>feof()</code> and <code>ferror()</code> return non-zero (true)
if the file has reached EOF or there has been an error,
respectively.</p>
<h3 class="unnumbered unlisted" id="example-159">Example</h3>
<p>Read binary data, checking for EOF or error:</p>
<div class="sourceCode" id="cb1296"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1296-1"><a href="stdio.html#cb1296-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1296-2"><a href="stdio.html#cb1296-2"></a></span>
<span id="cb1296-3"><a href="stdio.html#cb1296-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1296-4"><a href="stdio.html#cb1296-4"></a><span class="op">{</span></span>
<span id="cb1296-5"><a href="stdio.html#cb1296-5"></a>    <span class="dt">int</span> a<span class="op">;</span></span>
<span id="cb1296-6"><a href="stdio.html#cb1296-6"></a>    <span class="dt">FILE</span> <span class="op">*</span>fp<span class="op">;</span></span>
<span id="cb1296-7"><a href="stdio.html#cb1296-7"></a></span>
<span id="cb1296-8"><a href="stdio.html#cb1296-8"></a>    fp <span class="op">=</span> fopen<span class="op">(</span><span class="st">"numbers.dat"</span><span class="op">,</span> <span class="st">"r"</span><span class="op">);</span></span>
<span id="cb1296-9"><a href="stdio.html#cb1296-9"></a></span>
<span id="cb1296-10"><a href="stdio.html#cb1296-10"></a>    <span class="co">// read single ints at a time, stopping on EOF or error:</span></span>
<span id="cb1296-11"><a href="stdio.html#cb1296-11"></a></span>
<span id="cb1296-12"><a href="stdio.html#cb1296-12"></a>    <span class="cf">while</span><span class="op">(</span>fread<span class="op">(&amp;</span>a<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">int</span><span class="op">),</span> <span class="dv">1</span><span class="op">,</span> fp<span class="op">),</span> <span class="op">!</span>feof<span class="op">(</span>fp<span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span>ferror<span class="op">(</span>fp<span class="op">))</span> <span class="op">{</span></span>
<span id="cb1296-13"><a href="stdio.html#cb1296-13"></a>        printf<span class="op">(</span><span class="st">"Read %d</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> a<span class="op">);</span></span>
<span id="cb1296-14"><a href="stdio.html#cb1296-14"></a>    <span class="op">}</span></span>
<span id="cb1296-15"><a href="stdio.html#cb1296-15"></a></span>
<span id="cb1296-16"><a href="stdio.html#cb1296-16"></a>    <span class="cf">if</span> <span class="op">(</span>feof<span class="op">(</span>fp<span class="op">))</span></span>
<span id="cb1296-17"><a href="stdio.html#cb1296-17"></a>        printf<span class="op">(</span><span class="st">"End of file was reached.</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1296-18"><a href="stdio.html#cb1296-18"></a></span>
<span id="cb1296-19"><a href="stdio.html#cb1296-19"></a>    <span class="cf">if</span> <span class="op">(</span>ferror<span class="op">(</span>fp<span class="op">))</span></span>
<span id="cb1296-20"><a href="stdio.html#cb1296-20"></a>        printf<span class="op">(</span><span class="st">"An error occurred.</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1296-21"><a href="stdio.html#cb1296-21"></a></span>
<span id="cb1296-22"><a href="stdio.html#cb1296-22"></a>    fclose<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb1296-23"><a href="stdio.html#cb1296-23"></a><span class="op">}</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-150">See Also</h3>
<p><a href="stdio.html#man-fopen"><code>fopen()</code></a>, <a href="#man-fread"><code>fread()</code></a></p>
<hr>
<h2 data-number="61.25" id="man-perror"><span class="header-section-number">61.25</span> <code>perror()</code></h2>
<p>Print the last error message to <code>stderr</code></p>
<h3 class="unnumbered unlisted" id="synopsis-159">Synopsis</h3>
<div class="sourceCode" id="cb1297"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1297-1"><a href="stdio.html#cb1297-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1297-2"><a href="stdio.html#cb1297-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;errno.h&gt;</span><span class="pp">  </span><span class="co">// only if you want to directly use the "errno" var</span></span>
<span id="cb1297-3"><a href="stdio.html#cb1297-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1297-4"><a href="stdio.html#cb1297-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> perror<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>s<span class="op">);</span></span></code></pre></div>
<h3 class="unnumbered unlisted" id="description-159">Description</h3>
<p>Many functions, when they encounter an error condition for whatever
reason, will set a global variable called <code>errno</code> (in
<code>&lt;errno.h&gt;</code>) for you. <code>errno</code> is just an
interger representing a unique error.</p>
<p>But to you, the user, some number isn’t generally very useful. For
this reason, you can call <code>perror()</code> after an error occurs to
print what error has actually happened in a nice human-readable
string.</p>
<p>And to help you along, you can pass a parameter, <code>s</code>, that
will be prepended to the error string for you.</p>
<p>One more clever trick you can do is check the value of the
<code>errno</code> (you have to include <code>errno.h</code> to see it)
for specific errors and have your code do different things. Perhaps you
want to ignore certain errors but not others, for instance.</p>
<p>The standard only defines three values for <code>errno</code>, but
your system undoubtedly defines more. The three that are defined
are:</p>
<table>
<thead>
<tr class="header">
<th><code>errno</code></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>EDOM</code></td>
<td>Math operation outside domain.</td>
</tr>
<tr class="even">
<td><code>EILSEQ</code></td>
<td>Invalid sequence in multibyte to wide character encoding.</td>
</tr>
<tr class="odd">
<td><code>ERANGE</code></td>
<td>Result of operation doesn’t fit in specified type.</td>
</tr>
</tbody>
</table>
<p>The catch is that different systems define different values for
<code>errno</code>, so it’s not very portable beyond the above 3. The
good news is that at least the values are <em>largely</em> portable
between Unix-like systems, at least.</p>
<h3 class="unnumbered unlisted" id="return-value-157">Return Value</h3>
<p>Returns nothing at all! Sorry!</p>
<h3 class="unnumbered unlisted" id="example-160">Example</h3>
<p><a href="stdio.html#man-fseek"><code>fseek()</code></a> returns <code>-1</code>
on error, and sets <code>errno</code>, so let’s use it. Seeking on
<code>stdin</code> makes no sense, so it should generate an error:</p>
<div class="sourceCode" id="cb1298"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb1298-1"><a href="stdio.html#cb1298-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1298-2"><a href="stdio.html#cb1298-2"></a><span class="pp">#include </span><span class="im">&lt;errno.h&gt;</span><span class="pp"> </span><span class="co">// must include this to see "errno" in this example</span></span>
<span id="cb1298-3"><a href="stdio.html#cb1298-3"></a></span>
<span id="cb1298-4"><a href="stdio.html#cb1298-4"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb1298-5"><a href="stdio.html#cb1298-5"></a><span class="op">{</span></span>
<span id="cb1298-6"><a href="stdio.html#cb1298-6"></a>    <span class="cf">if</span> <span class="op">(</span>fseek<span class="op">(</span>stdin<span class="op">,</span> <span class="dv">10</span><span class="bu">L</span><span class="op">,</span> SEEK_SET<span class="op">)</span> <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb1298-7"><a href="stdio.html#cb1298-7"></a>        perror<span class="op">(</span><span class="st">"fseek"</span><span class="op">);</span></span>
<span id="cb1298-8"><a href="stdio.html#cb1298-8"></a></span>
<span id="cb1298-9"><a href="stdio.html#cb1298-9"></a>    fclose<span class="op">(</span>stdin<span class="op">);</span> <span class="co">// stop using this stream</span></span>
<span id="cb1298-10"><a href="stdio.html#cb1298-10"></a></span>
<span id="cb1298-11"><a href="stdio.html#cb1298-11"></a>    <span class="cf">if</span> <span class="op">(</span>fseek<span class="op">(</span>stdin<span class="op">,</span> <span class="dv">20</span><span class="bu">L</span><span class="op">,</span> SEEK_CUR<span class="op">)</span> <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1298-12"><a href="stdio.html#cb1298-12"></a></span>
<span id="cb1298-13"><a href="stdio.html#cb1298-13"></a>        <span class="co">// specifically check errno to see what kind of</span></span>
<span id="cb1298-14"><a href="stdio.html#cb1298-14"></a>        <span class="co">// error happened...this works on Linux, but your</span></span>
<span id="cb1298-15"><a href="stdio.html#cb1298-15"></a>        <span class="co">// mileage may vary on other systems!</span></span>
<span id="cb1298-16"><a href="stdio.html#cb1298-16"></a></span>
<span id="cb1298-17"><a href="stdio.html#cb1298-17"></a>        <span class="cf">if</span> <span class="op">(</span>errno <span class="op">==</span> EBADF<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1298-18"><a href="stdio.html#cb1298-18"></a>            perror<span class="op">(</span><span class="st">"fseek again, EBADF"</span><span class="op">);</span></span>
<span id="cb1298-19"><a href="stdio.html#cb1298-19"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb1298-20"><a href="stdio.html#cb1298-20"></a>            perror<span class="op">(</span><span class="st">"fseek again"</span><span class="op">);</span></span>
<span id="cb1298-21"><a href="stdio.html#cb1298-21"></a>        <span class="op">}</span></span>
<span id="cb1298-22"><a href="stdio.html#cb1298-22"></a>    <span class="op">}</span></span>
<span id="cb1298-23"><a href="stdio.html#cb1298-23"></a><span class="op">}</span></span></code></pre></div>
<p>And the output is:</p>
<div class="sourceCode" id="cb1299"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb1299-1"><a href="stdio.html#cb1299-1" aria-hidden="true" tabindex="-1"></a>fseek: Illegal seek</span>
<span id="cb1299-2"><a href="stdio.html#cb1299-2" aria-hidden="true" tabindex="-1"></a>fseek again, EBADF: Bad file descriptor</span></code></pre></div>
<h3 class="unnumbered unlisted" id="see-also-151">See Also</h3>
<p><a href="stdio.html#man-feof"><code>feof()</code></a>, <a href="#man-feof"><code>ferror()</code></a>, <a href="#man-strerror"><code>strerror()</code></a></p>




</body>